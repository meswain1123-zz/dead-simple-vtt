{"version":3,"sources":["assets/img/Fog.jpg","assets/img/maps/Basement-Study.jpg","assets/img/maps/Castle-Wall.jpg","assets/img/maps/Cave-Lair.jpg","assets/img/maps/Crossroads.jpg","assets/img/maps/Farmstead.jpg","assets/img/maps/Forest-Lair.jpg","assets/img/maps/Monster-Lair.jpg","assets/img/maps/Snow-Village.jpg","assets/img/maps/Swamp-Lair.jpg","assets/img/maps/Tavern.jpg","assets/img/maps/Underground-Complex.jpg","assets/img/maps/Urban-Lair.jpg","assets/img/maps/Wagon-Trail-and-Shrine.jpg","assets/img/maps/Waterfall-Cavern.jpg","assets/img/maps/AbandonedWarehouse.png","assets/img/maps/DaggerAlley.png","assets/img/maps/UnderDaggerAlley.png","assets/img/maps/TrollSkullAlleyBasement.png","assets/img/maps/TrollSkullAlleyHouse.png","assets/img/maps/WeddingRing.png","assets/img/tokens/Bald.png","assets/img/tokens/Bard.png","assets/img/tokens/BlondeHair.png","assets/img/tokens/BlondeWoman.png","assets/img/tokens/BlueSkin.png","assets/img/tokens/BlueSkin2.png","assets/img/tokens/DarkSkin.png","assets/img/tokens/DarkSkinF.png","assets/img/tokens/Dragonborn.png","assets/img/tokens/DragonbornFighter.png","assets/img/tokens/DwarfMale.png","assets/img/tokens/ElvenFemale.png","assets/img/tokens/ElvenFighter.png","assets/img/tokens/Eyebrows.png","assets/img/tokens/Eyebrows2.png","assets/img/tokens/Fedora.png","assets/img/tokens/GnomeMale.png","assets/img/tokens/GoliathBarb.png","assets/img/tokens/GreyHair.png","assets/img/tokens/HalflingMale.png","assets/img/tokens/Hood.png","assets/img/tokens/Hood2.png","assets/img/tokens/Human.png","assets/img/tokens/HumanFemale.png","assets/img/tokens/HumanFemale2.png","assets/img/tokens/HumanFighterF.png","assets/img/tokens/HumanFighterM.png","assets/img/tokens/HumanMale.png","assets/img/tokens/HumanMale2.png","assets/img/tokens/idk.png","assets/img/tokens/Knight.png","assets/img/tokens/OldWoman.png","assets/img/tokens/OldWoman2.png","assets/img/tokens/RedHair.png","assets/img/tokens/RedSkin.png","assets/img/tokens/Samurai.png","assets/img/tokens/Scarf.png","assets/img/tokens/TieflingFemale.png","assets/img/tokens/Wizard.png","assets/img/tokens/Rat.png","assets/img/tokens/Wererat.png","assets/img/tokens/Werewolf.png","assets/img/tokens/RugOfSmothering.jpeg","assets/img/tokens/PitTrapWSpikes.png","views/Home.js","models/PlayMap.ts","smartAPI.js","components/CreatePlayMap.tsx","components/LoadPlayMap.tsx","components/my-react-pan-zoom.tsx","models/PlayToken.ts","models/Mask.ts","models/FavoriteToken.ts","components/DisplayPlayMap.tsx","views/DM.tsx","views/Player.tsx","models/Map.ts","models/Token.ts","views/MainPage.tsx","App.tsx","serviceWorker.ts","redux/reducers/index.js","redux/store/index.js","redux/constants/actionTypes.js","index.tsx"],"names":["module","exports","Page","props","state","version","redirectTo","this","fromLogin","notFromLogin","to","Grid","container","spacing","direction","item","Component","HomePage","connect","dispatch","PlayMap","_id","name","map","tokens","lightMasks","darkMasks","fogMasks","zoom","dx","dy","toDBObj","playTokens","forEach","t","push","l","mapID","UnauthorizedError","message","prototype","Error","API","instance","getInstance","APIClass","logErrorReason","reason","console","log","Promise","reject","checkStatus","response","status","unauthorizedError","statusText","error","getAllVTT","userID","refresh","a","getMaps","maps","getTokens","getPlayMaps","playMaps","getFavoriteTokens","favoriteTokens","getMapsFromAPI","data","getSessionData","real","fetchData","processResponse","vttID","Name","createMap","postData","deleteMap","deleteData","updateMap","patchData","getTokensFromAPI","createToken","token","deleteToken","tokenID","updateToken","getPlayMapsFromAPI","getPlayMap","playMapID","createPlayMap","playMap","deletePlayMap","updatePlayMap","getFavoriteTokensFromAPI","createFavoriteToken","favoriteToken","deleteFavoriteToken","favoriteTokenID","updateFavoriteToken","path","options","fetch","mode","credentials","headers","Accept","then","catch","method","body","JSON","stringify","putData","retry","sessionName","noExpiry","json","undefined","expiresAt","Date","setHours","getHours","sessionObj","sessionStorage","setItem","relogin","user","sessionStr","getItem","parse","connector","app","addPlayMap","type","payload","api","renderHeader","key","selectMap","now","month","getMonth","toString","length","date","getDate","setState","selectedMap","getFullYear","processing","mapObj","res","newPlayMap","selectPlayMap","onBlur","trim","renderMain","FormControl","variant","fullWidth","InputLabel","htmlFor","OutlinedInput","id","autoComplete","value","onChange","e","target","labelWidth","FormHelperText","style","height","window","innerHeight","overflowY","renderMapList","renderSelectedMap","Button","disabled","onClick","color","xs","backgroundColor","cursor","gridWidth","gridHeight","width","src","file","alt","loadPlayMap","margin","ReactPanZoom","getInitialState","pandx","pandy","dragData","x","y","dragging","matrixData","panWrapper","panContainer","onMouseDown","enableClick","pageX","pageY","enablePan","newDragData","stopPropagation","nativeEvent","stopImmediatePropagation","preventDefault","onMouseUp","onPan","getNewMatrixData","deltaX","deltaY","onMouseMove","transform","nextProps","newMatrixData","className","userSelect","ref","children","React","defaultProps","PlayToken","size","MaskPoint","maskID","maskType","toClipPathPoint","Mask","points","toClipPath","clipPath","point","p","FavoriteToken","Container","css","ControlsContainer","styled","div","Heading","Icons","strong","selectedPlayMap","addFavoriteToken","countdown","setTimeout","refreshing","m","mapFinder","filter","m2","tokenFinder","t2","lastRefresh","zoomIn","zoomOut","clearSelectAndHover","mapMode","selected","hovered","addNewToken","selectedToken","i","tokenCount","tokenName","Math","round","tokenSize","selectedFavoriteToken","deletePlayToken","adjustPlayToken","theToken","selectedTokens","addNewFavorite","obj","newFavorite","deleteFavorite","adjustFavorite","deselecting","includes","shiftHeld","newSelected","s","innerWidth","thePoint","selectedMasks","selectedPoints","selectedPoint","renderFavoriteTokenList","edit","parseFloat","renderTokenList","renderPlayTokenList","parseInt","moveLMP","lmp","xy","maskFinder","pointFinder","addNewPoint","mask","theMask","firstPoint","deletePoint","deleteMask","masks","renderMaskList","controlSubMode","selectedMask","pkey","addNewMask","renderControls","controlMode","max","overflowX","onKeyDown","ctrlHeld","slideSelected","xChange","yChange","selToken","selPoint","onKeyUp","document","addEventListener","bind","removeEventListener","StyledReactPanZoom","position","left","top","opacity","FogOfWar","borderRadius","onMouseEnter","onMouseLeave","fontWeight","mkey","savePlayMap","selectedTokenID","hoveredTokenID","MapFile","BasementStudy","CastleWall","CaveLair","Crossroads","Farmstead","ForestLair","MonsterLair","SnowVillage","SwampLair","Tavern","UndergroundComplex","UrbanLair","WagonTrailandShrine","WaterfallCavern","AbandonedWarehouse","DaggerAlley","UnderDaggerAlley","TrollSkullAlleyBasement","TrollSkullAlleyHouse","WeddingRing","Map","fileName","TokenFile","Bald","Bard","BlondeHair","BlondeWoman","BlueSkin","BlueSkin2","DarkSkin","DarkSkinF","Dragonborn","DragonbornFighter","DwarfMale","ElvenFemale","ElvenFighter","Eyebrows","Eyebrows2","Fedora","GnomeMale","GoliathBarb","GreyHair","HalflingMale","Hood","Hood2","Human","HumanFemale","HumanFemale2","HumanFighterF","HumanFighterM","HumanMale","HumanMale2","IDK","Knight","OldWoman","OldWoman2","RedHair","RedSkin","Samurai","Scarf","TieflingFemale","Wizard","Rat","Wererat","Werewolf","RugOfSmothering","PitTrapWSpikes","Token","setMaps","setPlayMaps","setTokens","setFavoriteTokens","exact","component","DMPage","PlayerPage","AppLayout","marginLeft","updateDimensions","App","Boolean","location","hostname","match","initialState","isOn","rootReducer","reducers","action","Object","assign","playMapFinder","favoriteTokenFinder","session","sessionReducer","reducer","combineReducers","store","createStore","refreshFromLocalStorage","refreshOnCheckAuth","redirectPath","driver","validateSession","sessionService","initSessionService","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"oHAAAA,EAAOC,QAAU,m/B,wCCAjBD,EAAOC,QAAU,IAA0B,4C,gBCA3CD,EAAOC,QAAU,IAA0B,yC,gBCA3CD,EAAOC,QAAU,IAA0B,uC,gBCA3CD,EAAOC,QAAU,IAA0B,wC,gBCA3CD,EAAOC,QAAU,IAA0B,uC,gBCA3CD,EAAOC,QAAU,IAA0B,yC,gBCA3CD,EAAOC,QAAU,IAA0B,0C,gBCA3CD,EAAOC,QAAU,IAA0B,0C,gBCA3CD,EAAOC,QAAU,IAA0B,wC,gBCA3CD,EAAOC,QAAU,IAA0B,oC,gBCA3CD,EAAOC,QAAU,IAA0B,iD,gBCA3CD,EAAOC,QAAU,IAA0B,wC,gBCA3CD,EAAOC,QAAU,IAA0B,oD,gBCA3CD,EAAOC,QAAU,IAA0B,8C,gBCA3CD,EAAOC,QAAU,IAA0B,gD,gBCA3CD,EAAOC,QAAU,IAA0B,yC,gBCA3CD,EAAOC,QAAU,IAA0B,8C,gBCA3CD,EAAOC,QAAU,IAA0B,qD,gBCA3CD,EAAOC,QAAU,IAA0B,kD,gBCA3CD,EAAOC,QAAU,IAA0B,yC,gBCA3CD,EAAOC,QAAU,IAA0B,kC,gBCA3CD,EAAOC,QAAU,IAA0B,kC,gBCA3CD,EAAOC,QAAU,IAA0B,wC,gBCA3CD,EAAOC,QAAU,IAA0B,yC,gBCA3CD,EAAOC,QAAU,IAA0B,sC,gBCA3CD,EAAOC,QAAU,IAA0B,uC,gBCA3CD,EAAOC,QAAU,IAA0B,sC,gBCA3CD,EAAOC,QAAU,IAA0B,uC,gBCA3CD,EAAOC,QAAU,IAA0B,wC,gBCA3CD,EAAOC,QAAU,IAA0B,+C,gBCA3CD,EAAOC,QAAU,IAA0B,uC,gBCA3CD,EAAOC,QAAU,IAA0B,yC,gBCA3CD,EAAOC,QAAU,IAA0B,0C,gBCA3CD,EAAOC,QAAU,IAA0B,sC,gBCA3CD,EAAOC,QAAU,IAA0B,uC,gBCA3CD,EAAOC,QAAU,IAA0B,oC,gBCA3CD,EAAOC,QAAU,IAA0B,uC,gBCA3CD,EAAOC,QAAU,IAA0B,yC,gBCA3CD,EAAOC,QAAU,IAA0B,sC,gBCA3CD,EAAOC,QAAU,IAA0B,0C,gBCA3CD,EAAOC,QAAU,IAA0B,kC,gBCA3CD,EAAOC,QAAU,IAA0B,mC,gB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","file":"static/js/main.684fa0c3.chunk.js","sourcesContent":["module.exports = \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBoRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAARAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMi4xMwAA/9sAQwACAQEBAQECAQEBAgICAgIEAwICAgIFBAQDBAYFBgYGBQYGBgcJCAYHCQcGBggLCAkKCgoKCgYICwwLCgwJCgoK/9sAQwECAgICAgIFAwMFCgcGBwoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoK/8AAEQgACgAKAwEhAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A/n/ooAKKAP/Z\"","module.exports = __webpack_public_path__ + \"static/media/Basement-Study.a68280cb.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Castle-Wall.4fa9735d.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Cave-Lair.e48ad0f2.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Crossroads.b70bce05.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Farmstead.1802a7fa.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Forest-Lair.8706baa2.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Monster-Lair.906aa148.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Snow-Village.e08e1847.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Swamp-Lair.625e577e.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Tavern.9c60ea48.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Underground-Complex.ef43ba2b.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Urban-Lair.f9494f9d.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Wagon-Trail-and-Shrine.ad53d0a1.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Waterfall-Cavern.8d0ffe05.jpg\";","module.exports = __webpack_public_path__ + \"static/media/AbandonedWarehouse.5bb80286.png\";","module.exports = __webpack_public_path__ + \"static/media/DaggerAlley.469bcf6d.png\";","module.exports = __webpack_public_path__ + \"static/media/UnderDaggerAlley.4588f8f4.png\";","module.exports = __webpack_public_path__ + \"static/media/TrollSkullAlleyBasement.a7ce5ec0.png\";","module.exports = __webpack_public_path__ + \"static/media/TrollSkullAlleyHouse.9a7bd522.png\";","module.exports = __webpack_public_path__ + \"static/media/WeddingRing.cade6e88.png\";","module.exports = __webpack_public_path__ + \"static/media/Bald.741a853e.png\";","module.exports = __webpack_public_path__ + \"static/media/Bard.94af444d.png\";","module.exports = __webpack_public_path__ + \"static/media/BlondeHair.4fcc70e3.png\";","module.exports = __webpack_public_path__ + \"static/media/BlondeWoman.9762d835.png\";","module.exports = __webpack_public_path__ + \"static/media/BlueSkin.df8f5004.png\";","module.exports = __webpack_public_path__ + \"static/media/BlueSkin2.2603a58a.png\";","module.exports = __webpack_public_path__ + \"static/media/DarkSkin.e48fb0f3.png\";","module.exports = __webpack_public_path__ + \"static/media/DarkSkinF.ad2949fb.png\";","module.exports = __webpack_public_path__ + \"static/media/Dragonborn.ab16b141.png\";","module.exports = __webpack_public_path__ + \"static/media/DragonbornFighter.c21c5f7d.png\";","module.exports = __webpack_public_path__ + \"static/media/DwarfMale.2c31b739.png\";","module.exports = __webpack_public_path__ + \"static/media/ElvenFemale.4b6ed688.png\";","module.exports = __webpack_public_path__ + \"static/media/ElvenFighter.855d86de.png\";","module.exports = __webpack_public_path__ + \"static/media/Eyebrows.9e1fe3ec.png\";","module.exports = __webpack_public_path__ + \"static/media/Eyebrows2.e428b8ea.png\";","module.exports = __webpack_public_path__ + \"static/media/Fedora.ae081514.png\";","module.exports = __webpack_public_path__ + \"static/media/GnomeMale.0a1ba63d.png\";","module.exports = __webpack_public_path__ + \"static/media/GoliathBarb.33cfc33d.png\";","module.exports = __webpack_public_path__ + \"static/media/GreyHair.c1b9e380.png\";","module.exports = __webpack_public_path__ + \"static/media/HalflingMale.639efdd9.png\";","module.exports = __webpack_public_path__ + \"static/media/Hood.9db2c27f.png\";","module.exports = __webpack_public_path__ + \"static/media/Hood2.70d96a27.png\";","module.exports = __webpack_public_path__ + \"static/media/Human.52eda96a.png\";","module.exports = __webpack_public_path__ + \"static/media/HumanFemale.81c31b30.png\";","module.exports = __webpack_public_path__ + \"static/media/HumanFemale2.a4ff5aca.png\";","module.exports = __webpack_public_path__ + \"static/media/HumanFighterF.533cf974.png\";","module.exports = __webpack_public_path__ + \"static/media/HumanFighterM.77a0b7de.png\";","module.exports = __webpack_public_path__ + \"static/media/HumanMale.69efd308.png\";","module.exports = __webpack_public_path__ + \"static/media/HumanMale2.19c85bbc.png\";","module.exports = __webpack_public_path__ + \"static/media/idk.8cdd4c94.png\";","module.exports = __webpack_public_path__ + \"static/media/Knight.7d208560.png\";","module.exports = __webpack_public_path__ + \"static/media/OldWoman.b670e555.png\";","module.exports = __webpack_public_path__ + \"static/media/OldWoman2.28ceea26.png\";","module.exports = __webpack_public_path__ + \"static/media/RedHair.75d09fc6.png\";","module.exports = __webpack_public_path__ + \"static/media/RedSkin.bd87a612.png\";","module.exports = __webpack_public_path__ + \"static/media/Samurai.cbbf87ae.png\";","module.exports = __webpack_public_path__ + \"static/media/Scarf.e6d10ad6.png\";","module.exports = __webpack_public_path__ + \"static/media/TieflingFemale.1ee22c7c.png\";","module.exports = __webpack_public_path__ + \"static/media/Wizard.6cbb3902.png\";","module.exports = __webpack_public_path__ + \"static/media/Rat.7b728608.png\";","module.exports = __webpack_public_path__ + \"static/media/Wererat.d2f36299.png\";","module.exports = __webpack_public_path__ + \"static/media/Werewolf.17e32e13.png\";","module.exports = __webpack_public_path__ + \"static/media/RugOfSmothering.39f39c68.jpeg\";","module.exports = __webpack_public_path__ + \"static/media/PitTrapWSpikes.9c811852.png\";","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  Grid\r\n} from \"@material-ui/core\";\r\nimport {\r\n  // notFromLogin\r\n} from \"../redux/actions/index\";\r\n// import MediaCard from \"../components/Displays/MediaCard\";\r\n// import ContentEditableBox from \"../components/Inputs/ContentEditableBox\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    // fromLogin: state.app.fromLogin\r\n  };\r\n};\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    // notFromLogin: () => dispatch(notFromLogin({}))\r\n  };\r\n}\r\nclass Page extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      version: \"0\",\r\n      redirectTo: null\r\n    };\r\n  }\r\n\r\n  componentDidMount() {}\r\n\r\n  render() {\r\n    if (this.props.fromLogin) {\r\n      this.props.notFromLogin();\r\n    }\r\n    if (this.state.redirectTo !== null) {\r\n      return <Redirect to={this.state.redirectTo} />;\r\n    } else {\r\n      return (\r\n        <div>\r\n          <h3>Dead Simple Virtual Table Top</h3>\r\n          <p>\r\n            This is a Virtual Table Top I'm making for my friends\r\n            and I to use for D&amp;D.\r\n          </p>\r\n          <p>\r\n            It will have two pages.  The DM page and the player page.\r\n            There will be a canvas with zoom and pan capabilities.  \r\n            The canvas will have three layers.  The bottom layer is the \r\n            map.  The middle layer is the token layer, and it will have \r\n            tokens representing anything which can be interacted with.\r\n            The top layer is the fog layer, and it will contain the \r\n            fog of war as well as magical darkness.\r\n          </p>\r\n          <p>\r\n            The canvas will make an X * Y grid, and the map layer \r\n            will fill the grid.  Each token will have a numerical \r\n            size representing the diameter of the object.  Small\r\n            and Medium creatures will have a size of 1.  Large\r\n            creatures will have a size of 2.  Etc.  If tokens are \r\n            added to represent other objects with other shape types\r\n            (ladders, ropes, etc), then for now they can be represented\r\n            using multiple tokens.\r\n          </p>\r\n          <p>\r\n            The fog of war will cover everything except for what the \r\n            DM chooses to reveal.  It will be done by placing a 1x1 image\r\n            over each square of the map that is covered by the fog of war.\r\n            On the DM page these images will have 30% opacity.\r\n          </p>\r\n          <p>\r\n            The player page will show whatever the DM page shows, except \r\n            with opaque fog of war and no controls.  \r\n            (Later I might make it so the DM can set what the player page\r\n            sees independantly of what they see.)\r\n          </p>\r\n          <p>\r\n            The DM page will have these abilities:\r\n            Create a map (takes an image and X and Y values).\r\n            Open a map.\r\n            Pan/Zoom.\r\n            Add/Remove tokens.\r\n            Move tokens.\r\n            Add/Remove fog of war.\r\n          </p>\r\n          <p>\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item>\r\n                Known bugs:\r\n              </Grid>\r\n              <Grid item>\r\n                Clicking on the map doesn't always get the spot\r\n                you clicked quite right.  This is because I'm trying to translate\r\n                the actual pixels you're clicking on to the location on the grid,\r\n                and then back again for rendering.  The math is mostly right, but \r\n                things get funky with all the zooms and pans that need to be taken\r\n                into account.  I'll fix it later.\r\n              </Grid>\r\n              <Grid item>\r\n                I'm also still working on getting the UI for the Fog Of War controls \r\n                sorted out on the DM page.\r\n              </Grid>\r\n            </Grid>\r\n            \r\n          </p>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst HomePage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\nexport default HomePage;\r\n","\r\nimport { Map } from \"./Map\";\r\nimport { PlayToken } from \"./PlayToken\";\r\nimport { Mask } from \"./Mask\";\r\n\r\nexport class PlayMap {\r\n  _id: string;\r\n  name: string;\r\n  map: Map;\r\n  tokens: PlayToken[];\r\n  lightMasks: Mask[];\r\n  darkMasks: Mask[];\r\n  fogMasks: Mask[];\r\n  zoom: number;\r\n  dx: number;\r\n  dy: number;\r\n\r\n  constructor(\r\n    _id: string, \r\n    name: string,\r\n    map: Map,\r\n    tokens: PlayToken[], \r\n    lightMasks: Mask[],\r\n    darkMasks: Mask[],\r\n    fogMasks: Mask[],\r\n    zoom: number,\r\n    dx: number,\r\n    dy: number) {\r\n    this._id = _id;\r\n    this.name = name;\r\n    this.map = map;\r\n    this.tokens = tokens;\r\n    this.lightMasks = lightMasks;\r\n    this.darkMasks = darkMasks;\r\n    this.fogMasks = fogMasks;\r\n    this.zoom = zoom;\r\n    this.dx = dx;\r\n    this.dy = dy;\r\n  }\r\n\r\n  toDBObj = () => {\r\n    const playTokens: any[] = [];\r\n    this.tokens.forEach(t => {\r\n      playTokens.push(t.toDBObj());\r\n    });\r\n    const lightMasks: any[] = [];\r\n    this.lightMasks.forEach(l => {\r\n      lightMasks.push(l.toDBObj());\r\n    });\r\n    const darkMasks: any[] = [];\r\n    this.darkMasks.forEach(l => {\r\n      darkMasks.push(l.toDBObj());\r\n    });\r\n    const fogMasks: any[] = [];\r\n    this.fogMasks.forEach(l => {\r\n      fogMasks.push(l.toDBObj());\r\n    });\r\n    return {\r\n      _id: this._id,\r\n      name: this.name,\r\n      mapID: this.map._id,\r\n      playTokens: playTokens,\r\n      lightMasks: lightMasks,\r\n      darkMasks: darkMasks,\r\n      fogMasks: fogMasks,\r\n      zoom: this.zoom,\r\n      dx: this.dx,\r\n      dy: this.dy\r\n    };\r\n  }\r\n}","\r\n// This is our special type of Error that represents\r\n// when a request got a 401 Unauthorized response\r\nfunction UnauthorizedError(message) {\r\n  this.name = \"UnauthorizedError\";\r\n  this.message = message;\r\n}\r\nUnauthorizedError.prototype = new Error();\r\n\r\nvar API = (function() {\r\n  var instance;\r\n\r\n  function createInstance() {\r\n    var api = new APIClass();\r\n    return api;\r\n  }\r\n\r\n  return {\r\n    getInstance: function() {\r\n      if (!instance) {\r\n        instance = createInstance();\r\n      }\r\n      return instance;\r\n    }\r\n  };\r\n})();\r\n\r\nclass APIClass {\r\n  constructor() {\r\n    this.real = true;\r\n  }\r\n\r\n  logErrorReason = reason => {\r\n    // log the error reason but keep the rejection\r\n    console.log(\"Response error reason:\", reason);\r\n    return Promise.reject(reason);\r\n  };\r\n\r\n  checkStatus = response => {\r\n    if (response.status >= 200 && response.status < 300) {\r\n      return response;\r\n    } else if (response.status === 401) {\r\n      var unauthorizedError = new UnauthorizedError(response.statusText);\r\n      unauthorizedError.response = response;\r\n      return Promise.reject(unauthorizedError);\r\n    } else {\r\n      var error = new Error(response.statusText);\r\n      error.response = response;\r\n      return Promise.reject(error);\r\n    }\r\n  };\r\n  \r\n  getAllVTT = async (userID, refresh) => {\r\n    const maps = await this.getMaps(userID, refresh);\r\n    const tokens = await this.getTokens(userID, refresh);\r\n    const playMaps = await this.getPlayMaps(userID, refresh);\r\n    const favoriteTokens = await this.getFavoriteTokens(userID, refresh);\r\n\r\n    return {\r\n      maps: maps.maps,\r\n      tokens: tokens.tokens,\r\n      playMaps: playMaps.playMaps,\r\n      favoriteTokens: favoriteTokens.favoriteTokens\r\n    };\r\n  }\r\n\r\n  // Map\r\n  getMaps = async (userID, refresh = false) => {\r\n    if (refresh) {\r\n      return this.getMapsFromAPI(userID);\r\n    }\r\n    else {\r\n      const data = this.getSessionData(`maps`);\r\n      if (data !== null) {\r\n        return data;\r\n      }\r\n      else {\r\n        return this.getMapsFromAPI(userID);\r\n      }\r\n    }\r\n  };\r\n  getMapsFromAPI = async (userID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/vtt/getMaps/${userID}`\r\n      );\r\n      // const retry = async () => {\r\n      //   await this.relogin();\r\n      //   const response = await this.fetchData(\r\n      //     `/api/vtt/getMaps/${userID}`\r\n      //   );\r\n      //   return this.processResponse(response, null, `maps`);\r\n      // }\r\n      // const data = await this.processResponse(response, retry, `maps`);\r\n      const data = await this.processResponse(response, null, `maps`);\r\n      return data;\r\n    } else {\r\n      return [{ _id: -1, vttID: -1, Name: \"Alice\" }];\r\n    }\r\n  };\r\n\r\n  createMap = async (map) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/vtt/createMap\", { map });\r\n      // const retry = async () => {\r\n      //   await this.relogin();\r\n      //   const response = await this.postData(\"/api/vtt/createMap\", { map });\r\n      //   return this.processResponse(response);\r\n      // }\r\n      return this.processResponse(response, null);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteMap = async (mapID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/vtt/deleteMap\", { mapID });\r\n      // const retry = async () => {\r\n      //   await this.relogin();\r\n      //   const response = await this.deleteData(\"/api/vtt/deleteMap\", { mapID });\r\n      //   return this.processResponse(response);\r\n      // }\r\n      return this.processResponse(response, null);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateMap = async (map) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/vtt/updateMap\", { map });\r\n      // const retry = async () => {\r\n      //   await this.relogin();\r\n      //   const response = await this.patchData(\"/api/vtt/updateMap\", { map });\r\n      //   return this.processResponse(response);\r\n      // }\r\n      return this.processResponse(response, null);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n  \r\n  // Token\r\n  getTokens = async (userID, refresh = false) => {\r\n    if (refresh) {\r\n      return this.getTokensFromAPI(userID);\r\n    }\r\n    else {\r\n      const data = this.getSessionData(`tokens`);\r\n      if (data !== null) {\r\n        return data;\r\n      }\r\n      else {\r\n        return this.getTokensFromAPI(userID);\r\n      }\r\n    }\r\n  };\r\n  getTokensFromAPI = async (userID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/vtt/getTokens/${userID}`\r\n      );\r\n      // const retry = async () => {\r\n      //   await this.relogin();\r\n      //   const response = await this.fetchData(\r\n      //     `/api/vtt/getTokens/${userID}`\r\n      //   );\r\n      //   return this.processResponse(response, null, `tokens`);\r\n      // }\r\n      // const data = await this.processResponse(response, retry, `tokens`);\r\n      const data = await this.processResponse(response, null, `tokens`);\r\n      return data;\r\n    } else {\r\n      return [{ _id: -1, vttID: -1, Name: \"Alice\" }];\r\n    }\r\n  };\r\n\r\n  createToken = async (token) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/vtt/createToken\", { token });\r\n      // const retry = async () => {\r\n      //   await this.relogin();\r\n      //   const response = await this.postData(\"/api/vtt/createToken\", { token });\r\n      //   return this.processResponse(response);\r\n      // }\r\n      return this.processResponse(response, null);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteToken = async (tokenID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/vtt/deleteToken\", { tokenID });\r\n      // const retry = async () => {\r\n      //   await this.relogin();\r\n      //   const response = await this.deleteData(\"/api/vtt/deleteToken\", { tokenID });\r\n      //   return this.processResponse(response);\r\n      // }\r\n      return this.processResponse(response, null);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateToken = async (token) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/vtt/updateToken\", { token });\r\n      // const retry = async () => {\r\n      //   await this.relogin();\r\n      //   const response = await this.patchData(\"/api/vtt/updateToken\", { token });\r\n      //   return this.processResponse(response);\r\n      // }\r\n      return this.processResponse(response, null);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n  \r\n  // PlayMap\r\n  getPlayMaps = async (userID, refresh = false) => {\r\n    if (refresh) {\r\n      return this.getPlayMapsFromAPI(userID);\r\n    }\r\n    else {\r\n      const data = this.getSessionData(`playMaps`);\r\n      if (data !== null) {\r\n        return data;\r\n      }\r\n      else {\r\n        return this.getPlayMapsFromAPI(userID);\r\n      }\r\n    }\r\n  };\r\n  getPlayMapsFromAPI = async (userID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/vtt/getPlayMaps/${userID}`\r\n      );\r\n      // const retry = async () => {\r\n      //   await this.relogin();\r\n      //   const response = await this.fetchData(\r\n      //     `/api/vtt/getPlayMaps/${userID}`\r\n      //   );\r\n      //   return this.processResponse(response, null, `playMaps`);\r\n      // }\r\n      // const data = await this.processResponse(response, retry, `playMaps`);\r\n      const data = await this.processResponse(response, null, `playMaps`);\r\n      return data;\r\n    } else {\r\n      return [{ _id: -1, vttID: -1, Name: \"Alice\" }];\r\n    }\r\n  };\r\n  getPlayMap = async (playMapID) => {\r\n    const response = await this.fetchData(\r\n      `/api/vtt/getPlayMap/${playMapID}`\r\n    );\r\n    const data = await this.processResponse(response);\r\n    return data;\r\n  };\r\n\r\n  createPlayMap = async (playMap) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/vtt/createPlayMap\", { playMap });\r\n      // const retry = async () => {\r\n      //   await this.relogin();\r\n      //   const response = await this.postData(\"/api/vtt/createPlayMap\", { playMap });\r\n      //   return this.processResponse(response);\r\n      // }\r\n      return this.processResponse(response, null);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deletePlayMap = async (playMapID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/vtt/deletePlayMap\", { playMapID });\r\n      // const retry = async () => {\r\n      //   await this.relogin();\r\n      //   const response = await this.deleteData(\"/api/vtt/deletePlayMap\", { playMapID });\r\n      //   return this.processResponse(response);\r\n      // }\r\n      return this.processResponse(response, null);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updatePlayMap = async (playMap) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/vtt/updatePlayMap\", { playMap });\r\n      // const retry = async () => {\r\n      //   await this.relogin();\r\n      //   const response = await this.patchData(\"/api/vtt/updatePlayMap\", { playMap });\r\n      //   return this.processResponse(response);\r\n      // }\r\n      return this.processResponse(response, null);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n  \r\n  // FavoriteToken\r\n  getFavoriteTokens = async (userID, refresh = false) => {\r\n    if (refresh) {\r\n      return this.getFavoriteTokensFromAPI(userID);\r\n    }\r\n    else {\r\n      const data = this.getSessionData(`favoriteTokens`);\r\n      if (data !== null) {\r\n        return data;\r\n      }\r\n      else {\r\n        return this.getFavoriteTokensFromAPI(userID);\r\n      }\r\n    }\r\n  };\r\n  getFavoriteTokensFromAPI = async (userID) => {\r\n    if (this.real) {\r\n      const response = await this.fetchData(\r\n        `/api/vtt/getFavoriteTokens/${userID}`\r\n      );\r\n      // const retry = async () => {\r\n      //   await this.relogin();\r\n      //   const response = await this.fetchData(\r\n      //     `/api/vtt/getFavoriteTokens/${userID}`\r\n      //   );\r\n      //   return this.processResponse(response, null, `favoriteTokens`);\r\n      // }\r\n      // const data = await this.processResponse(response, retry, `favoriteTokens`);\r\n      const data = await this.processResponse(response, null, `favoriteTokens`);\r\n      return data;\r\n    } else {\r\n      return [{ _id: -1, vttID: -1, Name: \"Alice\" }];\r\n    }\r\n  };\r\n\r\n  createFavoriteToken = async (favoriteToken) => {\r\n    if (this.real) {\r\n      const response = await this.postData(\"/api/vtt/createFavoriteToken\", { favoriteToken });\r\n      // const retry = async () => {\r\n      //   await this.relogin();\r\n      //   const response = await this.postData(\"/api/vtt/createFavoriteToken\", { favoriteToken });\r\n      //   return this.processResponse(response);\r\n      // }\r\n      return this.processResponse(response, null);\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n  deleteFavoriteToken = async (favoriteTokenID) => {\r\n    if (this.real) {\r\n      const response = await this.deleteData(\"/api/vtt/deleteFavoriteToken\", { favoriteTokenID });\r\n      // const retry = async () => {\r\n      //   await this.relogin();\r\n      //   const response = await this.deleteData(\"/api/vtt/deleteFavoriteToken\", { favoriteTokenID });\r\n      //   return this.processResponse(response);\r\n      // }\r\n      return this.processResponse(response, null);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  updateFavoriteToken = async (favoriteToken) => {\r\n    if (this.real) {\r\n      const response = await this.patchData(\"/api/vtt/updateFavoriteToken\", { favoriteToken });\r\n      // const retry = async () => {\r\n      //   await this.relogin();\r\n      //   const response = await this.patchData(\"/api/vtt/updateFavoriteToken\", { favoriteToken });\r\n      //   return this.processResponse(response);\r\n      // }\r\n      return this.processResponse(response, null);\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  };\r\n\r\n  // Core API Calls\r\n  fetchData = async (path, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        ...options.headers\r\n      }\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  postData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"POST\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  putData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"PUT\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  patchData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"PATCH\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  deleteData = async (path, data, options = {}) => {\r\n    return await fetch(`${path}`, {\r\n      mode: \"cors\",\r\n      credentials: \"include\",\r\n      ...options,\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        ...options.headers\r\n      },\r\n      method: \"DELETE\",\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then(this.checkStatus)\r\n      .catch(this.logErrorReason);\r\n  };\r\n\r\n  processResponse = async (response, retry = null, sessionName = null, noExpiry = false) => {\r\n    const body = await response.json();\r\n    if (response.status !== 200) { \r\n      throw Error(body.message);\r\n    }\r\n    else if (body.error !== undefined && retry !== null) {\r\n      return retry();\r\n    } \r\n    else {\r\n      if (sessionName !== null) {\r\n        let expiresAt = new Date();\r\n        if (noExpiry) \r\n          expiresAt = \"never\";\r\n        else \r\n          expiresAt.setHours(expiresAt.getHours() + 1);\r\n        const sessionObj = {\r\n          expiresAt,\r\n          body\r\n        };\r\n        sessionStorage.setItem(sessionName, JSON.stringify(sessionObj));\r\n      }\r\n      return body;\r\n    };\r\n  };\r\n\r\n  relogin = async () => {\r\n    try {\r\n      const user = this.getSessionData(\"loginUser\");\r\n      if (user !== null) {\r\n        const response = await this.postData(\"/api/user/login\", user);\r\n        this.processResponse(response, null, \"user\", true);\r\n      }\r\n    }\r\n    catch {}\r\n  }\r\n\r\n  getSessionData = (sessionName) => {\r\n    const sessionStr = sessionStorage.getItem(sessionName);\r\n    if (sessionStr !== null) {\r\n      const sessionObj = JSON.parse(sessionStr);\r\n      if (sessionObj.expiresAt !== undefined && \r\n        (sessionObj.expiresAt === \"never\" || sessionObj.expiresAt > new Date())) {\r\n        return sessionObj.body;\r\n      }\r\n    }\r\n    return null;\r\n  };\r\n}\r\n\r\nexport default API;\r\n","\r\nimport React, { Component } from \"react\";\r\n// import { Redirect } from \"react-router-dom\";\r\nimport { connect, ConnectedProps } from 'react-redux';\r\nimport {\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  FormHelperText,\r\n  Button, Grid\r\n} from \"@material-ui/core\";\r\n// import {\r\n//   // notFromLogin\r\n// } from \"../redux/actions/index\";\r\nimport { PlayMap } from \"../models/PlayMap\";\r\nimport { Map } from \"../models/Map\";\r\n// import { PlayToken } from \"../models/PlayToken\";\r\n// import { Token } from \"../models/Token\";\r\nimport API from \"../smartAPI\";\r\n\r\n// This lets the user select a Map and use it to create a new\r\n// PlayMap.\r\n\r\n\r\ninterface AppState {\r\n  maps: Map[] | null\r\n}\r\n\r\ninterface RootState {\r\n  app: AppState\r\n}\r\n\r\nconst mapState = (state: RootState) => ({\r\n  maps: state.app.maps\r\n})\r\n\r\nconst mapDispatch = {\r\n  // setMaps: (maps: Map[]) => ({ type: 'SET_MAPS', payload: maps }),\r\n  // setPlayMaps: (playMaps: PlayMap[]) => ({ type: 'SET_PLAYMAPS', payload: playMaps }),\r\n  addPlayMap: (playMap: PlayMap) => ({ type: 'ADD_PLAYMAP', payload: playMap })\r\n}\r\n\r\nconst connector = connect(mapState, mapDispatch)\r\n\r\n// The inferred type will look like:\r\n// {isOn: boolean, toggleOn: () => void}\r\ntype PropsFromRedux = ConnectedProps<typeof connector>\r\n\r\ntype Props = PropsFromRedux & {\r\n  // backgroundColor: string\r\n  selectPlayMap: (playMap: PlayMap) => void\r\n}\r\n\r\nexport interface ICreatePlayMapStateType {\r\n  name: string;\r\n  selectedMap: Map | null;\r\n  error: string;\r\n  processing: boolean;\r\n}\r\n// export interface ICreatePlayMapProps {\r\n//   maps: Map[];\r\n//   addPlayMap: (playMap: PlayMap) => void;\r\n// }\r\nclass CreatePlayMap extends Component<\r\n  Props,\r\n  ICreatePlayMapStateType\r\n> {\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.state = {\r\n      name: \"\",\r\n      selectedMap: null,\r\n      error: \"\",\r\n      processing: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  api: any;\r\n\r\n  componentDidMount() {}\r\n\r\n  renderHeader = () => {\r\n    return (\r\n      <div key=\"header\"> \r\n        Select a Map and give the PlayMap a name.\r\n      </div>\r\n    );\r\n  };\r\n\r\n  selectMap = (map: Map) => {\r\n    if (this.state.name === \"\") {\r\n      const now = new Date();\r\n      let month: string = (now.getMonth() + 1).toString();\r\n      if (month.length === 1) {\r\n        month = \"0\" + month;\r\n      }\r\n      let date: string = now.getDate().toString();\r\n      if (date.length === 1) {\r\n        date = \"0\" + date;\r\n      }\r\n      this.setState({\r\n        selectedMap: map,\r\n        name: `${map.name} ${now.getFullYear()}${month}${date}`\r\n      });\r\n    } else {\r\n      this.setState({\r\n        selectedMap: map\r\n      });\r\n    }\r\n  };\r\n\r\n  createPlayMap = () => {\r\n    this.setState({\r\n      processing: true\r\n    }, () => {\r\n      if (this.state.selectedMap !== null) {\r\n        const mapObj: any = {\r\n          mapID: this.state.selectedMap._id, \r\n          name: this.state.name,\r\n          playTokens: [], \r\n          lightMasks: [],\r\n          darkMasks: [],\r\n          fogMasks: [],\r\n          zoom: 1, \r\n          dx: 0, \r\n          dy: 0\r\n        };\r\n\r\n        this.api.createPlayMap(mapObj).then((res: any) => {\r\n          if (res !== undefined && res.error === undefined && this.state.selectedMap) {\r\n            const newPlayMap: PlayMap = new PlayMap(res.playMapID, this.state.name, this.state.selectedMap, [], [], [], [], 1, 0, 0);\r\n            this.props.addPlayMap(newPlayMap);\r\n            this.props.selectPlayMap(newPlayMap);\r\n            this.setState({ processing: false });\r\n            // const maps: Map[] = [];\r\n            // res.maps.forEach((m: any) => {\r\n            //   maps.push(new Map(m._id, m.name, m.fileName, m.gridWidth, m.gridHeight));\r\n            // });\r\n            // this.props.setMaps(maps);\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  onBlur = () => {\r\n    this.setState(\r\n      { name: this.state.name.trim() }, \r\n      () => {\r\n        // Check to make sure the name isn't taken.  Low priority.    \r\n      }\r\n    );\r\n  };\r\n\r\n  renderMain = () => {\r\n    if (this.props.maps === null) {\r\n      return (<div key=\"main\">I'm invisible</div>);\r\n    } else {\r\n      return (\r\n        <Grid key=\"main\" container spacing={1} direction=\"column\">\r\n          <Grid item>\r\n            <FormControl variant=\"outlined\" fullWidth>\r\n              <InputLabel htmlFor=\"text_field_play_map_name\">PlayMap Name</InputLabel>\r\n                <OutlinedInput\r\n                  id={`text_field_play_map_name`}\r\n                  name={`text_field_play_map_name`}\r\n                  type=\"text\"\r\n                  autoComplete=\"Off\"\r\n                  error={this.state.error !== \"\"}\r\n                  value={this.state.name}\r\n                  onChange={e => {\r\n                    this.setState({ name: e.target.value });\r\n                  }}\r\n                  onBlur={() => {\r\n                    this.onBlur();\r\n                  }}\r\n                  labelWidth={120}\r\n                  fullWidth\r\n                />\r\n              <FormHelperText>\r\n                {this.state.error}\r\n              </FormHelperText>\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item \r\n            style={{ \r\n              height: (window.innerHeight - 200),\r\n              overflowY: \"scroll\"\r\n            }}\r\n            container spacing={1} direction=\"row\">\r\n            { this.renderMapList() }\r\n            { this.renderSelectedMap() }\r\n          </Grid>\r\n          <Grid item>\r\n            <Button disabled={ this.state.processing || this.state.selectedMap === null || this.state.name === \"\" } \r\n              onClick={this.createPlayMap} \r\n              variant=\"contained\" color=\"primary\">\r\n              Submit\r\n            </Button>\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n  };\r\n\r\n  renderMapList = () => {\r\n    if (this.props.maps !== null) {\r\n      return (\r\n        <Grid item xs={6} \r\n          container spacing={1} direction=\"column\">\r\n          Select a Map\r\n          {this.props.maps.map((map, key) => {\r\n            return (\r\n              <Grid item key={key} \r\n                onClick={() => {\r\n                  this.selectMap(map);\r\n                }}\r\n                style={{\r\n                  backgroundColor: (this.state.selectedMap && this.state.selectedMap._id === map._id ? \"blue\" : \"transparent\"),\r\n                  color: (this.state.selectedMap && this.state.selectedMap._id === map._id ? \"white\" : \"black\"),\r\n                  cursor: \"pointer\"\r\n                }}>\r\n                {map.name}\r\n              </Grid>\r\n            );\r\n          })}\r\n        </Grid>\r\n        );\r\n    } else {\r\n      return (<Grid item xs={6}>{\"I'm invisible!\"}</Grid>);\r\n    }\r\n  };\r\n\r\n  renderSelectedMap = () => {\r\n    if (this.state.selectedMap !== null) {\r\n      return (\r\n        <Grid item xs={6} container spacing={1} direction=\"column\">\r\n          <Grid item>\r\n            Grid Width: {this.state.selectedMap.gridWidth}\r\n          </Grid>\r\n          <Grid item>\r\n            Grid Height: {this.state.selectedMap.gridHeight}\r\n          </Grid>  \r\n          <Grid item>\r\n            <img \r\n              style={{ width: \"100%\" }} \r\n              src={this.state.selectedMap.file} \r\n              alt=\"testing\" />\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    } else {\r\n      return (<Grid item xs={6}></Grid>);\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return [\r\n      this.renderHeader(),\r\n      this.renderMain()\r\n    ];\r\n  }\r\n}\r\n\r\nexport default connector(CreatePlayMap);\r\n","\r\nimport React, { Component } from \"react\";\r\nimport { connect, ConnectedProps } from 'react-redux';\r\nimport {\r\n  // FormControl,\r\n  // OutlinedInput,\r\n  // InputLabel,\r\n  // FormHelperText,\r\n  Button, Grid\r\n} from \"@material-ui/core\";\r\n\r\nimport { PlayMap } from \"../models/PlayMap\";\r\n// import { Map } from \"../models/Map\";\r\n\r\n// import API from \"../smartAPI\";\r\n\r\n// This lets the user select a PlayMap to use.\r\n\r\ninterface AppState {\r\n  playMaps: PlayMap[] | null\r\n}\r\n\r\ninterface RootState {\r\n  app: AppState\r\n}\r\n\r\nconst mapState = (state: RootState) => ({\r\n  playMaps: state.app.playMaps\r\n})\r\n\r\nconst mapDispatch = {\r\n  // setMaps: (maps: Map[]) => ({ type: 'SET_MAPS', payload: maps }),\r\n  // setPlayMaps: (playMaps: PlayMap[]) => ({ type: 'SET_PLAYMAPS', payload: playMaps }),\r\n  // addPlayMap: (playMap: PlayMap) => ({ type: 'ADD_PLAYMAP', payload: playMap })\r\n}\r\n\r\nconst connector = connect(mapState, mapDispatch)\r\n\r\ntype PropsFromRedux = ConnectedProps<typeof connector>\r\n\r\ntype Props = PropsFromRedux & {\r\n  selectPlayMap: (playMap: PlayMap) => void;\r\n  mode: string;\r\n}\r\n\r\nexport interface ILoadPlayMapStateType {\r\n  selectedMap: PlayMap | null;\r\n}\r\n\r\nclass LoadPlayMap extends Component<\r\n  Props,\r\n  ILoadPlayMapStateType\r\n> {\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.state = {\r\n      selectedMap: null\r\n    };\r\n    // this.api = API.getInstance();\r\n  }\r\n\r\n  // api: any;\r\n\r\n  componentDidMount() {}\r\n\r\n  // renderHeader = () => {\r\n  //   return (\r\n  //     <div key=\"header\"> \r\n  //       Select a Map\r\n  //     </div>\r\n  //   );\r\n  // };\r\n\r\n  selectPlayMap = (map: PlayMap) => {\r\n    this.setState({\r\n      selectedMap: map\r\n    });\r\n  };\r\n\r\n  loadPlayMap = () => {\r\n    if (this.state.selectedMap !== null) {\r\n      this.props.selectPlayMap(this.state.selectedMap);\r\n    }\r\n  }\r\n\r\n  renderMain = () => {\r\n    if (this.props.playMaps === null) {\r\n      return (<div key=\"main\">I'm invisible</div>);\r\n    } else {\r\n      return (\r\n        <Grid key=\"main\" style={{ margin: 4 }} container spacing={1} direction=\"column\">\r\n          <Grid item \r\n            style={{ \r\n              height: (window.innerHeight - 200),\r\n              overflowY: \"scroll\"\r\n            }}\r\n            container spacing={1} direction=\"row\">\r\n            { this.renderMapList() }\r\n            { this.renderSelectedMap() }\r\n          </Grid>\r\n          <Grid item>\r\n            <Button disabled={ this.state.selectedMap === null } \r\n              onClick={this.loadPlayMap} \r\n              variant=\"contained\" color=\"primary\">\r\n              Submit\r\n            </Button>\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    }\r\n  };\r\n\r\n  renderMapList = () => {\r\n    if (this.props.playMaps !== null) {\r\n      return (\r\n        <Grid item xs={6} \r\n          container spacing={1} direction=\"column\">\r\n          Select a Map\r\n          {this.props.playMaps.map((map, key) => {\r\n            return (\r\n              <Grid item key={key} \r\n                onClick={() => {\r\n                  this.selectPlayMap(map);\r\n                }}\r\n                style={{\r\n                  backgroundColor: (this.state.selectedMap && this.state.selectedMap._id === map._id ? \"blue\" : \"transparent\"),\r\n                  color: (this.state.selectedMap && this.state.selectedMap._id === map._id ? \"white\" : \"black\"),\r\n                  cursor: \"pointer\"\r\n                }}>\r\n                {map.name}\r\n              </Grid>\r\n            );\r\n          })}\r\n        </Grid>\r\n        );\r\n    } else {\r\n      return (<Grid item xs={6}>{\"I'm invisible!\"}</Grid>);\r\n    }\r\n  };\r\n\r\n  renderSelectedMap = () => {\r\n    if (this.state.selectedMap !== null && this.props.mode === \"DM\") {\r\n      return (\r\n        <Grid item xs={6} container spacing={1} direction=\"column\">\r\n          <Grid item>\r\n            Grid Width: {this.state.selectedMap.map.gridWidth}\r\n          </Grid>\r\n          <Grid item>\r\n            Grid Height: {this.state.selectedMap.map.gridHeight}\r\n          </Grid>  \r\n          <Grid item>\r\n            <img \r\n              style={{ width: \"100%\" }} \r\n              src={this.state.selectedMap.map.file} \r\n              alt=\"testing\" />\r\n          </Grid>\r\n        </Grid>\r\n      );\r\n    } else {\r\n      return (<Grid item xs={6}></Grid>);\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return [\r\n      // this.renderHeader(),\r\n      this.renderMain()\r\n    ];\r\n  }\r\n}\r\n\r\nexport default connector(LoadPlayMap);\r\n","/*\r\n  Heavily inspired/lifted from this idea: https://stackoverflow.com/a/39311435/661768\r\n  without jqueryUI or jquery dependency.\r\n*/\r\nimport * as React from 'react';\r\n\r\nexport interface IDragData {\r\n  x: number;\r\n  y: number;\r\n  dx: number;\r\n  dy: number;\r\n}\r\n\r\nexport interface IReactPanZoomStateType {\r\n  dragging: boolean;\r\n  dragData: IDragData;\r\n  matrixData: number[];\r\n}\r\nexport interface IReactPanZoomProps {\r\n  height?: string;\r\n  width?: string;\r\n  className?: string;\r\n  enablePan?: boolean;\r\n  enableClick?: boolean;\r\n  zoom?: number;\r\n  pandx?: number;\r\n  pandy?: number;\r\n  onPan?: (x: number, y: number) => void;\r\n  onClick?: (x: number, y: number) => void;\r\n}\r\nexport default class ReactPanZoom extends React.PureComponent<\r\n  IReactPanZoomProps,\r\n  IReactPanZoomStateType\r\n> {\r\n  // In strict null checking setting default props doesn't seem to work. Hence the non-null assertion.\r\n  // :crossedfingers: it shouldn't be deprecated. Or the very least support defaultProps semantics as proposed\r\n  // in this PR: https://github.com/Microsoft/TypeScript/issues/23812\r\n  public static defaultProps: Partial<IReactPanZoomProps> = {\r\n    enablePan: true,\r\n    enableClick: false,\r\n    onPan: () => undefined,\r\n    onClick: () => undefined,\r\n    pandx: 0,\r\n    pandy: 0,\r\n    zoom: 1,\r\n  };\r\n  private getInitialState = () => {\r\n    const { pandx, pandy, zoom } = this.props;\r\n    const defaultDragData = {\r\n      dx: pandx!,\r\n      dy: pandy!,\r\n      x: 0,\r\n      y: 0,\r\n    };\r\n    return {\r\n      dragData: defaultDragData,\r\n      dragging: false,\r\n      matrixData: [\r\n        zoom!,\r\n        0,\r\n        0,\r\n        zoom!,\r\n        pandx!,\r\n        pandy!, // [zoom, skew, skew, zoom, dx, dy]\r\n      ],\r\n    };\r\n  };\r\n  // Used to set cursor while moving.\r\n  private panWrapper: any;\r\n  // Used to set transform for pan.\r\n  private panContainer: any;\r\n  public state = this.getInitialState();\r\n\r\n  private onMouseDown = (e: React.MouseEvent<EventTarget>) => {\r\n    if (this.props.enableClick && this.props.onClick) {\r\n      this.props.onClick(e.pageX, e.pageY);\r\n    }\r\n    if (!this.props.enablePan) {\r\n      return;\r\n    }\r\n    // eslint-disable-next-line\r\n    const { matrixData, dragData } = this.state;\r\n    const offsetX = matrixData[4];\r\n    const offsetY = matrixData[5];\r\n    const newDragData: IDragData = {\r\n      dx: offsetX,\r\n      dy: offsetY,\r\n      x: e.pageX,\r\n      y: e.pageY,\r\n    };\r\n    this.setState({\r\n      dragData: newDragData,\r\n      dragging: true,\r\n    });\r\n    if (this.panWrapper) {\r\n      this.panWrapper.style.cursor = 'move';\r\n    }\r\n    e.stopPropagation();\r\n    e.nativeEvent.stopImmediatePropagation();\r\n    e.preventDefault();\r\n  };\r\n\r\n  /**\r\n   * I didn't make this control.  \r\n   * I only tweaked it a little so I could have it respond \r\n   * differently in different modes.\r\n   * The original used this method, and I don't want to worry\r\n   * about fixing it for them.  I just added the UNSAFE_ to it\r\n   * so it would stop giving me warnings.\r\n   * @param nextProps \r\n   */\r\n  public UNSAFE_componentWillReceiveProps(nextProps: IReactPanZoomProps) {\r\n    const { matrixData } = this.state;\r\n    const { zoom = matrixData[0], pandx = matrixData[4], pandy = matrixData[5] } = nextProps;\r\n    const newMatrixData = [...this.state.matrixData];\r\n    if (matrixData[0] !== zoom) {\r\n      newMatrixData[0] = zoom || newMatrixData[0];\r\n      newMatrixData[3] = zoom || newMatrixData[3];\r\n    }\r\n    if (matrixData[4] !== pandx) {\r\n      newMatrixData[4] = pandx;\r\n    }\r\n    if (matrixData[5] !== pandy) {\r\n      newMatrixData[5] = pandy;\r\n    }\r\n    this.setState({\r\n      matrixData: newMatrixData,\r\n    });\r\n  }\r\n\r\n  private onMouseUp = () => {\r\n    this.setState({\r\n      dragging: false,\r\n    });\r\n    if (this.panWrapper) {\r\n      this.panWrapper.style.cursor = '';\r\n    }\r\n    if (!this.props.enableClick && this.props.onPan) {\r\n      this.props.onPan(this.state.matrixData[4], this.state.matrixData[5]);\r\n    }\r\n  };\r\n\r\n  private getNewMatrixData = (x: number, y: number): number[] => {\r\n    const { dragData, matrixData } = this.state;\r\n    const deltaX = dragData.x - x;\r\n    const deltaY = dragData.y - y;\r\n    matrixData[4] = dragData.dx - deltaX;\r\n    matrixData[5] = dragData.dy - deltaY;\r\n    return matrixData;\r\n  };\r\n\r\n  private onMouseMove = (e: React.MouseEvent<EventTarget>) => {\r\n    if (this.state.dragging) {\r\n      const matrixData = this.getNewMatrixData(e.pageX, e.pageY);\r\n      this.setState({\r\n        matrixData,\r\n      });\r\n      if (this.panContainer) {\r\n        this.panContainer.style.transform = `matrix(${this.state.matrixData.toString()})`;\r\n      }\r\n    }\r\n  };\r\n\r\n  public render() {\r\n    return (\r\n      <div\r\n        className={`pan-container ${this.props.className || ''}`}\r\n        onMouseDown={this.onMouseDown}\r\n        onMouseUp={this.onMouseUp}\r\n        onMouseMove={this.onMouseMove}\r\n        style={{\r\n          height: this.props.height,\r\n          userSelect: 'none',\r\n          width: this.props.width,\r\n          backgroundColor: \"black\"\r\n        }}\r\n        ref={(ref) => (this.panWrapper = ref)}\r\n      >\r\n        <div\r\n          ref={(ref) => (ref ? (this.panContainer = ref) : null)}\r\n          style={{\r\n            transform: `matrix(${this.state.matrixData.toString()})`,\r\n          }}\r\n        >\r\n          {this.props.children}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","\r\nimport { Token } from \"./Token\";\r\n\r\nexport class PlayToken {\r\n  id: number;\r\n  name: string;\r\n  token: Token;\r\n  x: number;\r\n  y: number;\r\n  size: number;\r\n\r\n  constructor(\r\n    id: number, \r\n    name: string,\r\n    token: Token,\r\n    x: number,\r\n    y: number,\r\n    size: number) {\r\n    this.id = id;\r\n    this.name = name;\r\n    this.token = token;\r\n    this.x = x;\r\n    this.y = y;\r\n    this.size = size;\r\n  }\r\n\r\n  toDBObj = () => {\r\n    return {\r\n      id: this.id,\r\n      name: this.name,\r\n      tokenID: this.token._id,\r\n      x: this.x,\r\n      y: this.y,\r\n      size: this.size\r\n    };\r\n  }\r\n}","\r\nexport class MaskPoint {\r\n  id: number;\r\n  maskID: number;\r\n  maskType: string;\r\n  x: number;\r\n  y: number;\r\n\r\n  constructor(\r\n    id: number, \r\n    maskID: number,\r\n    maskType: string,\r\n    x: number,\r\n    y: number,) {\r\n    this.id = id;\r\n    this.maskID = maskID;\r\n    this.maskType = maskType;\r\n    this.x = x;\r\n    this.y = y;\r\n  }\r\n\r\n  toClipPathPoint = (gridWidth: number, gridHeight: number) => {\r\n    // I still need to put some more translation code into this.  \r\n    // It shouldn't need to worry about pan and zoom from what I've seen.\r\n    // I think it's just going to be multiplying by 50, and adding some things to it.\r\n    let x = (this.x + gridWidth/2) * 50 - 50;\r\n    let y = (this.y + gridHeight/2) * 50 - 25;\r\n    return `${x},${y}`;\r\n  }\r\n\r\n  toDBObj = () => {\r\n    return {\r\n      id: this.id,\r\n      x: this.x,\r\n      y: this.y\r\n    };\r\n  }\r\n}\r\n\r\nexport class Mask {\r\n  id: number;\r\n  maskType: string;\r\n  points: MaskPoint[];\r\n\r\n  constructor(\r\n    id: number, \r\n    maskType: string,\r\n    points: MaskPoint[]) {\r\n    this.id = id;\r\n    this.maskType = maskType;\r\n    this.points = points;\r\n  }\r\n\r\n  toClipPath = (gridWidth: number, gridHeight: number) => {\r\n    let clipPath = \"\";\r\n    this.points.forEach(point => {\r\n      clipPath += point.toClipPathPoint(gridWidth, gridHeight) + \" \";\r\n    });\r\n    return clipPath;\r\n  }\r\n\r\n  toDBObj = () => {\r\n    const points: any[] = [];\r\n    this.points.forEach(p => {\r\n      points.push(p.toDBObj());\r\n    });\r\n    return {\r\n      id: this.id,\r\n      points\r\n    };\r\n  }\r\n}","\r\nimport { Token } from \"./Token\";\r\n\r\nexport class FavoriteToken {\r\n  _id: string;\r\n  name: string;\r\n  token: Token;\r\n  size: number;\r\n\r\n  constructor(\r\n    _id: string, \r\n    name: string,\r\n    token: Token,\r\n    size: number) {\r\n    this._id = _id;\r\n    this.name = name;\r\n    this.token = token;\r\n    this.size = size;\r\n  }\r\n\r\n\r\n  toDBObj = () => {\r\n    return {\r\n      _id: this._id,\r\n      name: this.name,\r\n      tokenID: this.token._id,\r\n      size: this.size\r\n    };\r\n  }\r\n}","\r\nimport React, { Component } from \"react\";\r\n// import { Redirect } from \"react-router-dom\";\r\nimport { connect, ConnectedProps } from 'react-redux';\r\nimport {\r\n  FormControl,\r\n  OutlinedInput,\r\n  InputLabel,\r\n  // FormHelperText,\r\n  Button, \r\n  Grid,\r\n  // List, ListItem, ListItemText\r\n} from \"@material-ui/core\";\r\nimport styled, { css } from \"styled-components\";\r\nimport ReactPanZoom from \"./my-react-pan-zoom\";\r\nimport { PlayMap } from \"../models/PlayMap\";\r\nimport { Map } from \"../models/Map\";\r\nimport { PlayToken } from \"../models/PlayToken\";\r\nimport { Mask, MaskPoint } from \"../models/Mask\";\r\nimport { FavoriteToken } from \"../models/FavoriteToken\";\r\nimport { Token } from \"../models/Token\";\r\nimport FogOfWar from \"../assets/img/Fog.jpg\";\r\nimport API from \"../smartAPI\";\r\n\r\n// This displays the PlayMap.  \r\n// If in DM mode then it can be modified, and the changes\r\n// are saved and carried over to Player mode.\r\n\r\nconst HEADER_HEIGHT = 30;\r\nconst Container = css`\r\n  height: calc(100vh - ${HEADER_HEIGHT}px);\r\n  width: 100vw;\r\n  overflow: hidden;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1;\r\n`;\r\nconst ControlsContainer = styled.div`\r\n  position: fixed;\r\n  background: lightgray;\r\n  height: 100%;\r\n  right: 0;\r\n  z-index: 2;\r\n  cursor: pointer;\r\n  user-select: none;\r\n\r\n  > div {\r\n    padding: 15px;\r\n    &:hover {\r\n      background: darkgray;\r\n    }\r\n    &:active {\r\n      box-shadow: 1px 1px 1px inset;\r\n    }\r\n  }\r\n`;\r\n\r\nconst Heading = styled.div`\r\n  background: dimgrey;\r\n  color: white;\r\n  height: ${HEADER_HEIGHT}px;\r\n  display: flex;\r\n  align-items: center;\r\n  padding-left: 10px;\r\n`;\r\n\r\nconst Icons = styled.strong`\r\n  font-size: 2rem;\r\n`;\r\n\r\n\r\ninterface AppState {\r\n  selectedPlayMap: PlayMap;\r\n  tokens: Token[];\r\n  favoriteTokens: FavoriteToken[];\r\n  maps: Map[];\r\n}\r\n\r\ninterface RootState {\r\n  app: AppState\r\n}\r\n\r\nconst mapState = (state: RootState) => ({\r\n  selectedPlayMap: state.app.selectedPlayMap,\r\n  tokens: state.app.tokens,\r\n  favoriteTokens: state.app.favoriteTokens,\r\n  maps: state.app.maps\r\n})\r\n\r\nconst mapDispatch = {\r\n  // setMaps: (maps: Map[]) => ({ type: 'SET_MAPS', payload: maps }),\r\n  // setPlayMaps: (playMaps: PlayMap[]) => ({ type: 'SET_PLAYMAPS', payload: playMaps }),\r\n  addFavoriteToken: (favoriteToken: FavoriteToken) => ({ type: 'ADD_FAVORITETOKEN', payload: favoriteToken }),\r\n  updateFavoriteToken: (favoriteToken: FavoriteToken) => ({ type: 'UPDATE_FAVORITETOKEN', payload: favoriteToken }),\r\n  updatePlayMap: (playMap: PlayMap) => ({ type: 'UPDATE_PLAYMAP', payload: playMap })\r\n}\r\n\r\nconst connector = connect(mapState, mapDispatch)\r\n\r\ntype PropsFromRedux = ConnectedProps<typeof connector>\r\n\r\ntype Props = PropsFromRedux & {\r\n  // playMap: PlayMap,\r\n  mode: string\r\n}\r\n\r\nexport interface IDisplayPlayMapStateType {\r\n  // playMap: PlayMap;\r\n  mapMode: string;\r\n  selected: (PlayToken | MaskPoint)[];\r\n  hovered: PlayToken | MaskPoint | null;\r\n  shiftHeld: boolean;\r\n  ctrlHeld: boolean;\r\n  deselecting: boolean;\r\n  controlMode: string;\r\n  controlSubMode: string;\r\n  lastRefresh: Date;\r\n  tokenName: string;\r\n  tokenSize: number;\r\n  tokenCount: number;\r\n  // These are separate from the other selected \r\n  // because they're in the controls instead of the map\r\n  selectedToken: Token | null;\r\n  selectedFavoriteToken: FavoriteToken | null;\r\n  selectedMask: Mask | null;\r\n  countdown: number;\r\n  refreshing: boolean;\r\n}\r\n// export interface IDisplayPlayMapProps {\r\n//   maps: Map[];\r\n//   addPlayMap: (playMap: PlayMap) => void;\r\n// }\r\nclass DisplayPlayMap extends Component<\r\n  Props,\r\n  IDisplayPlayMapStateType\r\n> {\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.state = {\r\n      // playMap: props.playMap,\r\n      mapMode: \"pan\",\r\n      selected: [],\r\n      hovered: null,\r\n      shiftHeld: false,\r\n      ctrlHeld: false,\r\n      deselecting: false,\r\n      controlMode: \"main\",\r\n      controlSubMode: \"add\",\r\n      lastRefresh: new Date(),\r\n      tokenName: \"\",\r\n      tokenSize: 1,\r\n      tokenCount: 1,\r\n      selectedToken: null,\r\n      selectedFavoriteToken: null,\r\n      selectedMask: null,\r\n      countdown: 2,\r\n      refreshing: false\r\n    };\r\n    this.api = API.getInstance();\r\n    // TODO: I need to put in a method that contacts the API and \r\n    // gets the latest version of this.props.selectedPlayMap.\r\n    // Once it gets it, it updates it, and then restarts the timer.\r\n    // I'll have the timer be displayed, and it only triggers when\r\n    // it hits zero.\r\n    // Other than that I just need to test it.\r\n    // And of course get some more maps to put in, and set up some \r\n    // PlayMaps.\r\n    if (props.mode !== \"DM\") {\r\n      setTimeout(this.countdown, 1000);\r\n    }\r\n  }\r\n\r\n  api: any;\r\n\r\n  componentDidMount() {\r\n    document.addEventListener(\"keydown\", this.onKeyDown.bind(this));\r\n    document.addEventListener(\"keyup\", this.onKeyUp.bind(this));\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    document.removeEventListener(\"keydown\", this.onKeyDown.bind(this));\r\n    document.removeEventListener(\"keyup\", this.onKeyUp.bind(this));\r\n  }\r\n\r\n  countdown = () => {\r\n    if (this.state.countdown > 0) {\r\n      this.setState({ countdown: this.state.countdown - 1 }, () => {\r\n        setTimeout(this.countdown, 1000);\r\n      });\r\n    } else {\r\n      this.setState({ countdown: 0, refreshing: true }, this.refresh);\r\n    }\r\n  }\r\n\r\n  refresh = () => {\r\n    this.api.getPlayMap(this.props.selectedPlayMap._id).then((m: any) => {\r\n      const mapFinder: Map[] = this.props.maps.filter(m2 => m2._id === m.mapID);\r\n      if (mapFinder.length === 1)\r\n      {\r\n        const map: Map = mapFinder[0];\r\n        const playTokens: PlayToken[] = [];\r\n        m.playTokens.forEach((t: any) => {\r\n          const tokenFinder: Token[] = this.props.tokens.filter(t2 => t2._id === t.tokenID);\r\n          if (tokenFinder.length === 1)\r\n          {\r\n            const token: Token = tokenFinder[0];\r\n            playTokens.push(new PlayToken(t.id, t.name, token, t.x, t.y, t.size));\r\n          }\r\n        });\r\n        const lightMasks: Mask[] = [];\r\n        m.lightMasks.forEach((l: any) => {\r\n          const points: MaskPoint[] = [];\r\n          l.points.forEach((p: any) => {\r\n            points.push(new MaskPoint(p.id, l.id, \"light\", p.x, p.y));\r\n          });\r\n          lightMasks.push(new Mask(l.id, \"light\", points));\r\n        });\r\n        const darkMasks: Mask[] = [];\r\n        m.darkMasks.forEach((l: any) => {\r\n          const points: MaskPoint[] = [];\r\n          l.points.forEach((p: any) => {\r\n            points.push(new MaskPoint(p.id, l.id, \"dark\", p.x, p.y));\r\n          });\r\n          darkMasks.push(new Mask(l.id, \"dark\", points));\r\n        });\r\n        const fogMasks: Mask[] = [];\r\n        m.fogMasks.forEach((l: any) => {\r\n          const points: MaskPoint[] = [];\r\n          l.points.forEach((p: any) => {\r\n            points.push(new MaskPoint(p.id, l.id, \"fog\", p.x, p.y));\r\n          });\r\n          fogMasks.push(new Mask(l.id, \"fog\", points));\r\n        });\r\n        const playMap = new PlayMap(m._id, m.name, map, playTokens, lightMasks, darkMasks, fogMasks, m.zoom, m.dx, m.dy);\r\n        this.props.updatePlayMap(playMap);\r\n        this.setState({ \r\n          refreshing: false, \r\n          countdown: 4, \r\n          lastRefresh: new Date() \r\n        }, () => {\r\n          setTimeout(this.countdown, 1000);\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  zoomIn = () => {\r\n    if (this.props.selectedPlayMap) {\r\n      const newPlayMap = this.props.selectedPlayMap;\r\n      newPlayMap.zoom += 0.2;\r\n      // this.api.updatePlayMap(newPlayMap.toDBObj()).then(() => {\r\n        this.props.updatePlayMap(newPlayMap);\r\n        this.setState({\r\n          lastRefresh: new Date()\r\n        });\r\n      // });\r\n    }\r\n  };\r\n\r\n  zoomOut = () => {\r\n    if (this.props.selectedPlayMap) {\r\n      const newPlayMap = this.props.selectedPlayMap;\r\n      newPlayMap.zoom -= 0.2;\r\n      // this.api.updatePlayMap(newPlayMap.toDBObj()).then(() => {\r\n        this.props.updatePlayMap(newPlayMap);\r\n        this.setState({\r\n          lastRefresh: new Date()\r\n        });\r\n      // });\r\n    }\r\n  };\r\n\r\n  clearSelectAndHover = () => {\r\n    this.setState({\r\n      mapMode: \"pan\",\r\n      selected: [],\r\n      hovered: null\r\n    });\r\n  };\r\n\r\n  addNewToken = () => {\r\n    if (this.props.selectedPlayMap) {\r\n      const newPlayMap = this.props.selectedPlayMap;\r\n      if (this.state.selectedToken) {\r\n        const token = this.state.selectedToken;\r\n        for (let i = 0; i < this.state.tokenCount; i++) {\r\n          newPlayMap.tokens.push(new PlayToken(\r\n            newPlayMap.tokens.length,\r\n            this.state.tokenName.trim() + (i > 0 ? ` ${i+1}` : \"\"),\r\n            token,\r\n            i - Math.round(this.state.tokenCount / 2),\r\n            0,\r\n            this.state.tokenSize)\r\n          );\r\n        }\r\n        // this.api.updatePlayMap(newPlayMap.toDBObj()).then(() => {\r\n        this.props.updatePlayMap(newPlayMap);\r\n        this.setState({\r\n          lastRefresh: new Date()\r\n        });\r\n        // });\r\n      } else if (this.state.selectedFavoriteToken) {\r\n        const token = this.state.selectedFavoriteToken;\r\n        newPlayMap.tokens.push(new PlayToken(\r\n          newPlayMap.tokens.length,\r\n          this.state.tokenName.trim(),\r\n          token.token,\r\n          0,\r\n          0,\r\n          this.state.tokenSize)\r\n        );\r\n        // this.api.updatePlayMap(newPlayMap.toDBObj()).then(() => {\r\n          this.props.updatePlayMap(newPlayMap);\r\n          this.setState({\r\n            lastRefresh: new Date()\r\n          });\r\n        // });\r\n      }\r\n    }\r\n  };\r\n\r\n  deletePlayToken = (token: PlayToken) => {\r\n    if (this.props.selectedPlayMap) {\r\n      const newPlayMap = this.props.selectedPlayMap;\r\n      newPlayMap.tokens = newPlayMap.tokens.filter(t => t.id !== token.id);\r\n      newPlayMap.tokens.filter(t => t.id > token.id).forEach(t => {\r\n        t.id--;\r\n      });\r\n      this.props.updatePlayMap(newPlayMap);\r\n      this.setState({\r\n        lastRefresh: new Date()\r\n      });\r\n    }\r\n  }\r\n\r\n  adjustPlayToken = (t: PlayToken, name: string, size: number, x: number, y: number) => {\r\n    if (this.props.selectedPlayMap) {\r\n      const newPlayMap = this.props.selectedPlayMap;\r\n      const theToken: PlayToken = t;\r\n      const selectedTokens = newPlayMap.tokens.filter(t => t.id === theToken.id);\r\n      if (selectedTokens.length === 1) {\r\n        const selectedToken = selectedTokens[0];\r\n        selectedToken.name = name;\r\n        selectedToken.size = size;\r\n        selectedToken.x = x;\r\n        selectedToken.y = y;\r\n\r\n        // this.api.updatePlayMap(newPlayMap.toDBObj()).then(() => {\r\n        this.props.updatePlayMap(newPlayMap);\r\n        this.setState({\r\n          lastRefresh: new Date(),\r\n          hovered: selectedToken\r\n        });\r\n        // });\r\n      }\r\n    }\r\n  }\r\n\r\n  addNewFavorite = () => {\r\n    if (this.state.selectedToken) {\r\n      const token = this.state.selectedToken;\r\n\r\n      const obj = {\r\n        name: this.state.tokenName,\r\n        tokenID: token._id,\r\n        size: this.state.tokenSize\r\n      };\r\n\r\n      this.api.createFavoriteToken(obj).then((res: any) => {\r\n        const newFavorite = new FavoriteToken(res.favoriteTokenID, this.state.tokenName, token, this.state.tokenSize);\r\n        this.props.addFavoriteToken(newFavorite);\r\n        this.setState({\r\n          lastRefresh: new Date()\r\n        });\r\n      });\r\n\r\n      // newPlayMap.tokens.push(new PlayToken(\r\n      //   newPlayMap.tokens.length,\r\n      //   this.state.tokenName.trim(),\r\n      //   token,\r\n      //   0,\r\n      //   0,\r\n      //   this.state.tokenSize)\r\n      // );\r\n      // // this.api.updatePlayMap(newPlayMap.toDBObj()).then(() => {\r\n      //   this.props.updatePlayMap(newPlayMap);\r\n      //   this.setState({\r\n      //     lastRefresh: new Date()\r\n      //   });\r\n      // // });\r\n    }\r\n  };\r\n\r\n  deleteFavorite = (token: PlayToken) => {\r\n    if (this.props.selectedPlayMap) {\r\n      const newPlayMap = this.props.selectedPlayMap;\r\n      newPlayMap.tokens = newPlayMap.tokens.filter(t => t.id !== token.id);\r\n      newPlayMap.tokens.filter(t => t.id > token.id).forEach(t => {\r\n        t.id--;\r\n      });\r\n      this.props.updatePlayMap(newPlayMap);\r\n      this.setState({\r\n        lastRefresh: new Date()\r\n      });\r\n    }\r\n  }\r\n\r\n  adjustFavorite = (t: FavoriteToken, name: string, size: number) => {\r\n    const theToken: FavoriteToken = t;\r\n    const tokenFinder = this.props.favoriteTokens.filter(t => t._id === theToken._id);\r\n    if (tokenFinder.length === 1) {\r\n      const token = tokenFinder[0];\r\n      token.name = name;\r\n      token.size = size;\r\n\r\n      this.api.updateFavoriteToken(token.toDBObj()).then(() => {\r\n        this.props.updateFavoriteToken(token);\r\n        this.setState({\r\n          lastRefresh: new Date()\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  onPan = (dx: number, dy: number) => {\r\n    // I need to make this respond to some types of held keys with clicks\r\n    // I'm thinking I'm going to make it allow for multiSelects\r\n    if (this.props.selectedPlayMap && this.props.mode === \"DM\") {\r\n      const newPlayMap = this.props.selectedPlayMap;\r\n      if (this.state.deselecting) {\r\n        this.setState({ deselecting: false });\r\n      } else {\r\n        if (this.state.hovered === null && this.state.selected.length === 0) {\r\n          // it's an actual pan, so pan it.\r\n          newPlayMap.dx = dx;\r\n          newPlayMap.dy = dy;\r\n          // this.api.updatePlayMap(newPlayMap.toDBObj()).then(() => {\r\n            this.props.updatePlayMap(newPlayMap);\r\n            this.setState({\r\n              lastRefresh: new Date()\r\n            });\r\n          // });\r\n        } else if (this.state.hovered !== null && this.state.selected.includes(this.state.hovered)) {\r\n          // They're deselecting.\r\n          // If it goes here, there's a problem\r\n          // const newSelected = this.state.selected.filter(s => s !== this.state.hovered);\r\n          // if (newSelected.length === 0) {\r\n          //   this.setState({\r\n          //     selected: newSelected, \r\n          //     mapMode: \"pan\"\r\n          //   });\r\n          // } else {\r\n          //   this.setState({\r\n          //     selected: newSelected\r\n          //   });\r\n          // }\r\n        } else if (this.state.hovered !== null) {\r\n          // They're selecting\r\n          if (this.state.selected.length === 0 || this.state.shiftHeld) {\r\n            const newSelected = this.state.selected;\r\n            newSelected.push(this.state.hovered);\r\n            this.setState({\r\n              selected: newSelected,\r\n              mapMode: \"move\"\r\n            });\r\n          }\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  onClick = (x: number, y: number) => {\r\n    // I need to make this respond to some types of held keys plus clicks\r\n    if (this.state.selected.length > 0 && this.props.selectedPlayMap && this.props.mode === \"DM\") {\r\n      const newPlayMap: PlayMap = this.props.selectedPlayMap;\r\n      if (this.state.hovered === null) {\r\n        // They're moving stuff.  Only allow it if there's only one selected.\r\n        if (this.state.selected.length === 1) {\r\n          this.state.selected.forEach((s: PlayToken | MaskPoint) => {\r\n            // Need to figure out what the selected thing is and move it to the location\r\n            if (s instanceof PlayToken) {\r\n              const theToken: PlayToken = s;\r\n              const selectedTokens = newPlayMap.tokens.filter(t => t.id === theToken.id);\r\n              if (selectedTokens.length === 1) {\r\n                const selectedToken = selectedTokens[0];\r\n                // This translates the clicked coordinates into the proper format\r\n                selectedToken.x = Math.round(((x - (window.innerWidth / 2) - newPlayMap.dx + 25) / newPlayMap.zoom)/50);\r\n                selectedToken.y = Math.round(((y - (window.innerHeight / 2) - newPlayMap.dy - 37.5) / newPlayMap.zoom)/50);\r\n\r\n                // this.api.updatePlayMap(newPlayMap.toDBObj()).then(() => {\r\n                  this.props.updatePlayMap(newPlayMap);\r\n                  this.setState({\r\n                    lastRefresh: new Date(),\r\n                    hovered: selectedToken\r\n                  });\r\n                // });\r\n              }\r\n            } else if (s instanceof MaskPoint) {\r\n              const thePoint: MaskPoint = s;\r\n              const masks = s.maskType === \"light\" ? this.props.selectedPlayMap.lightMasks : s.maskType === \"dark\" ? this.props.selectedPlayMap.darkMasks : this.props.selectedPlayMap.fogMasks;\r\n              const selectedMasks = masks.filter(m => m.id === thePoint.maskID);\r\n              if (selectedMasks.length === 1) {\r\n                const selectedMask = selectedMasks[0];\r\n                const selectedPoints = selectedMask.points.filter(p => p.id === thePoint.id);\r\n                if (selectedPoints.length === 1) {\r\n                  const selectedPoint = selectedPoints[0];\r\n                  // This translates the clicked coordinates into the proper format\r\n                  // selectedPoint.x = Math.round(((x - (window.innerWidth / 2) - newPlayMap.dx + 25) / newPlayMap.zoom)/50);\r\n                  // selectedPoint.y = Math.round(((y - (window.innerHeight / 2) - newPlayMap.dy - 37.5) / newPlayMap.zoom)/50);\r\n                  selectedPoint.x = ((x - (window.innerWidth / 2) - newPlayMap.dx + 50) / newPlayMap.zoom)/50;\r\n                  selectedPoint.y = ((y - (window.innerHeight / 2) - newPlayMap.dy) / newPlayMap.zoom)/50;\r\n\r\n                  // this.api.updatePlayMap(newPlayMap.toDBObj()).then(() => {\r\n                    this.props.updatePlayMap(newPlayMap);\r\n                    this.setState({\r\n                      lastRefresh: new Date(),\r\n                      hovered: selectedPoint\r\n                    });\r\n                  // });\r\n                }\r\n              }\r\n            }\r\n          });\r\n        }\r\n      } else if (!this.state.selected.includes(this.state.hovered)) {\r\n        // They're selecting\r\n        if (this.state.selected.length === 0 || this.state.shiftHeld) {\r\n          const newSelected = this.state.selected;\r\n          newSelected.push(this.state.hovered);\r\n          this.setState({\r\n            selected: newSelected,\r\n            mapMode: \"move\"\r\n          });\r\n        }\r\n      } else {\r\n        // They're deselecting.\r\n        const newSelected = this.state.selected.filter(s => s !== this.state.hovered);\r\n        if (newSelected.length === 0) {\r\n          this.setState({\r\n            selected: newSelected, \r\n            mapMode: \"pan\",\r\n            deselecting: true\r\n          });\r\n        } else {\r\n          this.setState({\r\n            selected: newSelected,\r\n            deselecting: true\r\n          });\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  renderFavoriteTokenList = (edit: boolean) => {\r\n    if (edit) {\r\n      return (\r\n        <Grid item container spacing={1} direction=\"row\">\r\n        { this.props.favoriteTokens.map((t, key) => {\r\n          return (\r\n            <Grid item key={key} container spacing={1} direction=\"row\">\r\n              <Grid item xs={6}>\r\n                <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor={`text_field_favorite_token_name_${key}`}>Name</InputLabel>\r\n                    <OutlinedInput\r\n                      id={`text_field_favorite_token_name_${key}`}\r\n                      name={`text_field_favorite_token_name_${key}`}\r\n                      type=\"text\"\r\n                      autoComplete=\"Off\"\r\n                      value={t.name}\r\n                      onChange={e => {\r\n                        this.adjustFavorite(t, e.target.value, t.size);\r\n                        // this.setState({ tokenName: e.target.value });\r\n                      }}\r\n                      labelWidth={40}\r\n                      fullWidth\r\n                    />\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item xs={6}>\r\n                <FormControl variant=\"outlined\" fullWidth>\r\n                  <InputLabel htmlFor={`text_field_favorite_token_size_${key}`}>Size</InputLabel>\r\n                    <OutlinedInput\r\n                      id={`text_field_favorite_token_size_${key}`}\r\n                      name={`text_field_favorite_token_size_${key}`}\r\n                      type=\"number\"\r\n                      autoComplete=\"Off\"\r\n                      value={t.size}\r\n                      onChange={e => {\r\n                        this.adjustFavorite(t, t.name, parseFloat(e.target.value));\r\n                        // this.setState({ tokenSize: parseFloat(e.target.value) });\r\n                      }}\r\n                      labelWidth={40}\r\n                      fullWidth\r\n                    />\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item xs={6}>\r\n                <img src={t.token.file} style={{ width: 140 }} alt={t.name} />\r\n              </Grid>\r\n              <Grid item xs={6}>\r\n                <Button onClick={() => {\r\n                  // this.deleteFavoriteToken(t);\r\n                }}>\r\n                  Delete\r\n                </Button>\r\n              </Grid>\r\n            </Grid>  \r\n          );\r\n        })}\r\n        </Grid>\r\n      );\r\n    } else {\r\n      return (\r\n        <Grid item container spacing={1} direction=\"row\">\r\n        { this.props.favoriteTokens.map((token, key) => {\r\n          return (\r\n            <Grid item key={key} xs={6} \r\n              style={{ cursor: \"pointer\", backgroundColor: (this.state.selectedFavoriteToken !== null && token._id === this.state.selectedFavoriteToken._id ? \"blue\" : \"transparent\") }}\r\n              onClick={() => {\r\n                this.setState({\r\n                  selectedFavoriteToken: token,\r\n                  selectedToken: null,\r\n                  tokenName: token.name,\r\n                  tokenSize: token.size\r\n                });\r\n              }}>\r\n              <img src={token.token.file} style={{ width: 140 }} alt={token.name} />\r\n              {token.name}\r\n            </Grid>\r\n          );\r\n        })}\r\n        </Grid>\r\n      );\r\n    }\r\n  }\r\n\r\n  renderTokenList = () => {\r\n    return (\r\n      <Grid item container spacing={1} direction=\"row\">\r\n      { this.props.tokens.map((token, key) => {\r\n        return (\r\n          <Grid item key={key} xs={6} \r\n            style={{ cursor: \"pointer\", backgroundColor: (this.state.selectedToken !== null && token._id === this.state.selectedToken._id ? \"blue\" : \"transparent\") }}\r\n            onClick={() => {\r\n              this.setState({\r\n                selectedToken: token,\r\n                selectedFavoriteToken: null\r\n              });\r\n            }}>\r\n            <img src={token.file} style={{ width: 140 }} alt={token.file} />\r\n          </Grid>\r\n        );\r\n      })}\r\n      </Grid>\r\n    );\r\n  }\r\n\r\n  renderPlayTokenList = () => {\r\n    return (\r\n      <Grid item container spacing={1} direction=\"column\">\r\n      { this.props.selectedPlayMap.tokens.map((t, key) => {\r\n        return (\r\n          <Grid item key={key} container spacing={1} direction=\"row\">\r\n            <Grid item xs={3}>\r\n              <FormControl variant=\"outlined\" fullWidth>\r\n                <InputLabel htmlFor={`text_field_play_token_name_${key}`}>Name</InputLabel>\r\n                  <OutlinedInput\r\n                    id={`text_field_play_token_name_${key}`}\r\n                    name={`text_field_play_token_name_${key}`}\r\n                    type=\"text\"\r\n                    autoComplete=\"Off\"\r\n                    value={t.name}\r\n                    onChange={e => {\r\n                      this.adjustPlayToken(t, e.target.value, t.size, t.x, t.y);\r\n                      // this.setState({ tokenName: e.target.value });\r\n                    }}\r\n                    labelWidth={40}\r\n                    fullWidth\r\n                  />\r\n              </FormControl>\r\n            </Grid>\r\n            <Grid item xs={3}>\r\n              <FormControl variant=\"outlined\" fullWidth>\r\n                <InputLabel htmlFor={`text_field_play_token_size_${key}`}>Size</InputLabel>\r\n                  <OutlinedInput\r\n                    id={`text_field_play_token_size_${key}`}\r\n                    name={`text_field_play_token_size_${key}`}\r\n                    type=\"number\"\r\n                    autoComplete=\"Off\"\r\n                    value={t.size}\r\n                    onChange={e => {\r\n                      this.adjustPlayToken(t, t.name, parseFloat(e.target.value), t.x, t.y);\r\n                      // this.setState({ tokenSize: parseFloat(e.target.value) });\r\n                    }}\r\n                    labelWidth={40}\r\n                    fullWidth\r\n                  />\r\n              </FormControl>\r\n            </Grid>\r\n            <Grid item xs={3}>\r\n              <FormControl variant=\"outlined\" fullWidth>\r\n                <InputLabel htmlFor={`text_field_lmp_x_${key}`}>X</InputLabel>\r\n                  <OutlinedInput\r\n                    id={`text_field_lmp_x_${key}`}\r\n                    name={`text_field_lmp_x_${key}`}\r\n                    type=\"number\"\r\n                    autoComplete=\"Off\"\r\n                    value={t.x}\r\n                    onChange={e => {\r\n                      this.adjustPlayToken(t, t.name, t.size, parseInt(e.target.value), t.y);\r\n                      // this.moveLMP(p, 'y', e.target.value);\r\n                      // this.setState({ tokenSize: parseInt(e.target.value) });\r\n                    }}\r\n                    labelWidth={40}\r\n                    fullWidth\r\n                  />\r\n              </FormControl>\r\n            </Grid>\r\n            <Grid item xs={3}>\r\n              <FormControl variant=\"outlined\" fullWidth>\r\n                <InputLabel htmlFor={`text_field_lmp_y_${key}`}>Y</InputLabel>\r\n                  <OutlinedInput\r\n                    id={`text_field_lmp_y_${key}`}\r\n                    name={`text_field_lmp_y_${key}`}\r\n                    type=\"number\"\r\n                    autoComplete=\"Off\"\r\n                    value={t.y}\r\n                    onChange={e => {\r\n                      this.adjustPlayToken(t, t.name, t.size, t.x, parseInt(e.target.value));\r\n                      // this.moveLMP(p, 'y', e.target.value);\r\n                      // this.setState({ tokenSize: parseInt(e.target.value) });\r\n                    }}\r\n                    labelWidth={40}\r\n                    fullWidth\r\n                  />\r\n              </FormControl>\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <img src={t.token.file} style={{ width: 140 }} alt={t.name} />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Button onClick={() => {\r\n                this.deletePlayToken(t);\r\n              }}>\r\n                Delete\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n        );\r\n      })}\r\n      </Grid>\r\n    );\r\n  }\r\n\r\n  moveLMP = (lmp: MaskPoint, xy: string, value: string) => {\r\n    if (this.props.selectedPlayMap) {\r\n      const newPlayMap = this.props.selectedPlayMap;\r\n      const masks = lmp.maskType === \"light\" ? newPlayMap.lightMasks : lmp.maskType === \"dark\" ? newPlayMap.darkMasks : newPlayMap.fogMasks;\r\n      const maskFinder = masks.filter(m => m.id === lmp.maskID);\r\n      if (maskFinder.length === 1) {\r\n        const mask = maskFinder[0];\r\n        const pointFinder = mask.points.filter(p => p.id === lmp.id);\r\n        if (pointFinder.length === 1) {\r\n          const point = pointFinder[0];\r\n          if (xy === 'x') {\r\n            point.x = parseFloat(value);\r\n          } else {\r\n            point.y = parseFloat(value);\r\n          }\r\n        }\r\n      }\r\n      // this.api.updatePlayMap(newPlayMap.toDBObj()).then(() => {\r\n        this.props.updatePlayMap(newPlayMap);\r\n        this.setState({\r\n          lastRefresh: new Date()\r\n        });\r\n      // });\r\n    }\r\n  }\r\n\r\n  addNewPoint = (mask: Mask) => {\r\n    if (this.props.selectedPlayMap) {\r\n      const newPlayMap = this.props.selectedPlayMap;\r\n      const masks = mask.maskType === \"light\" ? newPlayMap.lightMasks : mask.maskType === \"dark\" ? newPlayMap.darkMasks : newPlayMap.fogMasks;\r\n      const maskFinder = masks.filter(m => m.id === mask.id);\r\n      if (maskFinder.length === 1) {\r\n        const theMask = maskFinder[0];\r\n        const firstPoint = theMask.points[0];\r\n        theMask.points.push(new MaskPoint(theMask.points.length, theMask.id, theMask.maskType, firstPoint.x + 1, firstPoint.y + 1));\r\n\r\n        // this.api.updatePlayMap(newPlayMap.toDBObj()).then(() => {\r\n          this.props.updatePlayMap(newPlayMap);\r\n          this.setState({\r\n            lastRefresh: new Date()\r\n          });\r\n        // });\r\n      }\r\n    }\r\n  }\r\n\r\n  deletePoint = (point: MaskPoint) => {\r\n    if (this.props.selectedPlayMap) {\r\n      const newPlayMap = this.props.selectedPlayMap;\r\n      const masks = point.maskType === \"light\" ? newPlayMap.lightMasks : point.maskType === \"dark\" ? newPlayMap.darkMasks : newPlayMap.fogMasks;\r\n      const maskFinder = masks.filter(m => m.id === point.maskID);\r\n      if (maskFinder.length === 1) {\r\n        const mask = maskFinder[0];\r\n        mask.points = mask.points.filter(p => p.id !== point.id);\r\n        mask.points.filter(p => p.id > point.id).forEach(p => {\r\n          p.id--;\r\n        });\r\n        this.props.updatePlayMap(newPlayMap);\r\n        this.setState({\r\n          lastRefresh: new Date()\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  deleteMask = (mask: Mask) => {\r\n    if (this.props.selectedPlayMap) {\r\n      const newPlayMap = this.props.selectedPlayMap;\r\n      let masks = mask.maskType === \"light\" ? newPlayMap.lightMasks : mask.maskType === \"dark\" ? newPlayMap.darkMasks : newPlayMap.fogMasks;\r\n      masks = masks.filter(m => m.id !== mask.id);\r\n      masks.filter(m => m.id > mask.id).forEach(m => {\r\n        m.id--;\r\n      });\r\n      if (mask.maskType === \"light\") {\r\n        newPlayMap.lightMasks = masks;\r\n      } else if (mask.maskType === \"dark\") {\r\n        newPlayMap.darkMasks = masks;\r\n      } else {\r\n        newPlayMap.fogMasks = masks;\r\n      }\r\n      this.props.updatePlayMap(newPlayMap);\r\n      this.setState({\r\n        lastRefresh: new Date()\r\n      });\r\n    }\r\n  }\r\n\r\n  renderMaskList = () => {\r\n    const masks = this.state.controlSubMode === \"light\" ? this.props.selectedPlayMap.lightMasks : this.state.controlSubMode === \"dark\" ? this.props.selectedPlayMap.darkMasks : this.props.selectedPlayMap.fogMasks;\r\n    return (\r\n      <Grid container spacing={1} direction=\"column\">\r\n        <Grid item>{ this.state.controlSubMode === \"light\" ? \"Light Masks\" : this.state.controlSubMode === \"dark\" ? \"Dark Masks\" : \"Fog Masks\" }</Grid>\r\n      { masks.map((mask: Mask, key) => {\r\n        return (\r\n          <Grid item key={key} \r\n            style={{ cursor: \"pointer\", backgroundColor: (this.state.selectedMask !== null && mask === this.state.selectedMask ? \"blue\" : \"transparent\") }}\r\n            container spacing={1} direction=\"column\">\r\n            <Grid item\r\n              onClick={() => {\r\n                this.setState({\r\n                  selectedMask: mask\r\n                });\r\n              }}>\r\n              {mask.toClipPath(this.props.selectedPlayMap.map.gridWidth, this.props.selectedPlayMap.map.gridHeight)}\r\n            </Grid>\r\n            { this.state.selectedMask !== null && mask === this.state.selectedMask && \r\n              <Grid item container spacing={1} direction=\"column\">\r\n                { mask.points.map((p, pkey) => {\r\n                  return (\r\n                    <Grid item container key={pkey} spacing={1} direction=\"row\">\r\n                      <Grid item xs={6}>\r\n                        <FormControl variant=\"outlined\" fullWidth>\r\n                          <InputLabel htmlFor={`text_field_lmp_x_${pkey}`}>X</InputLabel>\r\n                            <OutlinedInput\r\n                              id={`text_field_lmp_x_${pkey}`}\r\n                              name={`text_field_lmp_x_${pkey}`}\r\n                              type=\"number\"\r\n                              autoComplete=\"Off\"\r\n                              value={p.x}\r\n                              onChange={e => {\r\n                                this.moveLMP(p, 'x', e.target.value);\r\n                                // this.setState({ tokenName: e.target.value });\r\n                              }}\r\n                              labelWidth={40}\r\n                              fullWidth\r\n                            />\r\n                        </FormControl>\r\n                      </Grid>\r\n                      <Grid item xs={6}>\r\n                        <FormControl variant=\"outlined\" fullWidth>\r\n                          <InputLabel htmlFor={`text_field_lmp_y_${pkey}`}>Y</InputLabel>\r\n                            <OutlinedInput\r\n                              id={`text_field_lmp_y_${pkey}`}\r\n                              name={`text_field_lmp_y_${pkey}`}\r\n                              type=\"number\"\r\n                              autoComplete=\"Off\"\r\n                              value={p.y}\r\n                              onChange={e => {\r\n                                this.moveLMP(p, 'y', e.target.value);\r\n                                // this.setState({ tokenSize: parseInt(e.target.value) });\r\n                              }}\r\n                              labelWidth={40}\r\n                              fullWidth\r\n                            />\r\n                        </FormControl>\r\n                      </Grid>\r\n                      <Grid item xs={12}>\r\n                        <Button onClick={() => {\r\n                          this.deletePoint(p);\r\n                        }}>\r\n                          Delete\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                  );\r\n                })}\r\n                <Grid item>\r\n                  <Button onClick={() => {\r\n                    this.addNewPoint(mask);\r\n                  }}>\r\n                    Add New Point\r\n                  </Button>\r\n                  <Button onClick={() => {\r\n                    this.deleteMask(mask);\r\n                  }}>\r\n                    Delete Mask\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            }\r\n            \r\n          </Grid>\r\n        );\r\n      })}\r\n      </Grid>\r\n    );\r\n  }\r\n\r\n  addNewMask = () => {\r\n    if (this.props.selectedPlayMap) {\r\n      const newPlayMap = this.props.selectedPlayMap;\r\n      const masks = this.state.controlSubMode === \"light\" ? newPlayMap.lightMasks : this.state.controlSubMode === \"dark\" ? newPlayMap.darkMasks : newPlayMap.fogMasks;\r\n      const points: MaskPoint[] = [\r\n        new MaskPoint(0, masks.length, this.state.controlSubMode, 0, 0),\r\n        new MaskPoint(1, masks.length, this.state.controlSubMode, 1, 0),\r\n        new MaskPoint(2, masks.length, this.state.controlSubMode, 1, 1),\r\n        new MaskPoint(3, masks.length, this.state.controlSubMode, 0, 1)\r\n      ];\r\n      masks.push(new Mask(\r\n        masks.length, this.state.controlSubMode, \r\n        points)\r\n      );\r\n      // this.api.updatePlayMap(newPlayMap.toDBObj()).then(() => {\r\n        this.props.updatePlayMap(newPlayMap);\r\n        this.setState({\r\n          lastRefresh: new Date()\r\n        });\r\n      // });\r\n    }\r\n  };\r\n\r\n  renderControls = () => {\r\n    if (this.props.selectedPlayMap && this.props.mode === \"DM\") {\r\n      if (this.state.controlMode === \"tokens\") {\r\n        return (\r\n          <ControlsContainer key=\"controls\" style={{ width: 300 }}>\r\n            <Heading>Tokens</Heading>\r\n            <Grid container spacing={1} direction=\"row\">\r\n              <Grid item xs={6}>\r\n                <Button onClick={() => { this.setState({ controlSubMode: \"add\" }); }}>\r\n                  Add\r\n                </Button>\r\n              </Grid>\r\n              <Grid item xs={6}>\r\n                <Button onClick={() => { this.setState({ controlSubMode: \"edit\" }); }}>\r\n                  Edit\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n            { this.state.controlSubMode === \"add\" ? \r\n              <Grid container spacing={1} direction=\"column\">\r\n                <Grid container spacing={1} direction=\"row\">\r\n                  <Grid item xs={4}>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                      <InputLabel htmlFor=\"text_field_play_token_name\">Name</InputLabel>\r\n                        <OutlinedInput\r\n                          id={`text_field_play_token_name`}\r\n                          name={`text_field_play_token_name`}\r\n                          type=\"text\"\r\n                          autoComplete=\"Off\"\r\n                          value={this.state.tokenName}\r\n                          onChange={e => {\r\n                            this.setState({ tokenName: e.target.value });\r\n                          }}\r\n                          labelWidth={40}\r\n                          fullWidth\r\n                        />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item xs={4}>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                      <InputLabel htmlFor=\"text_field_play_token_size\">Size</InputLabel>\r\n                        <OutlinedInput\r\n                          id={`text_field_play_token_size`}\r\n                          name={`text_field_play_token_size`}\r\n                          type=\"number\"\r\n                          autoComplete=\"Off\"\r\n                          value={this.state.tokenSize}\r\n                          onChange={e => {\r\n                            this.setState({ tokenSize: parseFloat(e.target.value) });\r\n                          }}\r\n                          labelWidth={40}\r\n                          fullWidth\r\n                        />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item xs={4}>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                      <InputLabel htmlFor=\"text_field_play_token_count\">Count</InputLabel>\r\n                        <OutlinedInput\r\n                          id={`text_field_play_token_count`}\r\n                          name={`text_field_play_token_count`}\r\n                          type=\"number\"\r\n                          autoComplete=\"Off\"\r\n                          value={this.state.tokenCount}\r\n                          onChange={e => {\r\n                            this.setState({ tokenCount: Math.max(1, parseInt(e.target.value)) });\r\n                          }}\r\n                          labelWidth={40}\r\n                          fullWidth\r\n                        />\r\n                    </FormControl>\r\n                  </Grid>\r\n                </Grid>\r\n                <Grid item>\r\n                  <div style={{ height: (window.innerHeight - 400), overflowX: \"hidden\", overflowY: \"scroll\" }}>\r\n                    <Grid container spacing={1} direction=\"column\">\r\n                      <Grid item>\r\n                        { this.renderFavoriteTokenList(false) }\r\n                      </Grid>\r\n                      <Grid item>\r\n                        { this.renderTokenList() }\r\n                      </Grid>\r\n                    </Grid>\r\n                  </div>\r\n                </Grid>\r\n              </Grid>\r\n            :\r\n              <Grid container spacing={1} direction=\"column\" style={{ height: (window.innerHeight - 300), overflowX: \"hidden\", overflowY: \"scroll\" }}>\r\n                { this.renderPlayTokenList() }\r\n              </Grid>\r\n            }\r\n            <Grid container spacing={1} direction=\"row\">\r\n              <Grid item xs={6}>\r\n              { this.state.controlSubMode === \"add\" && \r\n                <Button \r\n                  onClick={this.addNewToken} \r\n                  variant=\"contained\" color=\"primary\"\r\n                  disabled={ this.state.tokenName === \"\" || (this.state.selectedToken === null && this.state.selectedFavoriteToken === null)} \r\n                >\r\n                  Add New Token\r\n                </Button>\r\n              }\r\n              </Grid>\r\n              <Grid item xs={6}>\r\n                <Button \r\n                  onClick={() => {\r\n                    this.setState({ controlMode: \"main\" });\r\n                  }} \r\n                  variant=\"contained\" color=\"primary\"\r\n                >\r\n                  Close\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n          </ControlsContainer>\r\n        );\r\n      } else if (this.state.controlMode === \"masks\") {\r\n        return (\r\n          <ControlsContainer key=\"controls\" style={{ width: 300 }}>\r\n            <Heading>Masks</Heading>\r\n            <Grid container spacing={1} direction=\"row\">\r\n              <Grid item xs={4}>\r\n                <Button onClick={() => { this.setState({ controlSubMode: \"light\" }); }}>\r\n                  Light\r\n                </Button>\r\n              </Grid>\r\n              <Grid item xs={4}>\r\n                <Button onClick={() => { this.setState({ controlSubMode: \"dark\" }); }}>\r\n                  Dark\r\n                </Button>\r\n              </Grid>\r\n              <Grid item xs={4}>\r\n                <Button onClick={() => { this.setState({ controlSubMode: \"fog\" }); }}>\r\n                  Fog\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n            <Grid container spacing={1} direction=\"column\">\r\n              <Grid item style={{ height: (window.innerHeight - 280), overflowX: \"hidden\", overflowY: \"scroll\" }}>\r\n                { this.renderMaskList() }\r\n              </Grid>\r\n              <Grid item container spacing={1} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <Button \r\n                    onClick={this.addNewMask} \r\n                    variant=\"contained\" color=\"primary\"\r\n                  >\r\n                    Add New Mask\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <Button \r\n                    onClick={() => {\r\n                      this.setState({ controlMode: \"main\" });\r\n                    }} \r\n                    variant=\"contained\" color=\"primary\"\r\n                  >\r\n                    Close\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </ControlsContainer>\r\n        );\r\n      } else if (this.state.controlMode === \"favorites\") {\r\n        return (\r\n          <ControlsContainer key=\"controls\" style={{ width: 300 }}>\r\n            <Heading>Favorites</Heading>\r\n            <Grid container spacing={1} direction=\"row\">\r\n              <Grid item xs={6}>\r\n                <Button onClick={() => { this.setState({ controlSubMode: \"add\" }); }}>\r\n                  Add\r\n                </Button>\r\n              </Grid>\r\n              <Grid item xs={6}>\r\n                <Button onClick={() => { this.setState({ controlSubMode: \"edit\" }); }}>\r\n                  Edit\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n            { this.state.controlSubMode === \"add\" ? \r\n              <Grid container spacing={1} direction=\"row\">\r\n                <Grid item xs={6}>\r\n                  <FormControl variant=\"outlined\" fullWidth>\r\n                    <InputLabel htmlFor=\"text_field_play_token_name\">Name</InputLabel>\r\n                      <OutlinedInput\r\n                        id={`text_field_play_token_name`}\r\n                        name={`text_field_play_token_name`}\r\n                        type=\"text\"\r\n                        autoComplete=\"Off\"\r\n                        value={this.state.tokenName}\r\n                        onChange={e => {\r\n                          this.setState({ tokenName: e.target.value });\r\n                        }}\r\n                        labelWidth={40}\r\n                        fullWidth\r\n                      />\r\n                  </FormControl>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <FormControl variant=\"outlined\" fullWidth>\r\n                    <InputLabel htmlFor=\"text_field_play_token_size\">Size</InputLabel>\r\n                      <OutlinedInput\r\n                        id={`text_field_play_token_size`}\r\n                        name={`text_field_play_token_size`}\r\n                        type=\"number\"\r\n                        autoComplete=\"Off\"\r\n                        value={this.state.tokenSize}\r\n                        onChange={e => {\r\n                          this.setState({ tokenSize: parseFloat(e.target.value) });\r\n                        }}\r\n                        labelWidth={40}\r\n                        fullWidth\r\n                      />\r\n                  </FormControl>\r\n                </Grid>\r\n                <div style={{ height: (window.innerHeight - 400), overflowX: \"hidden\", overflowY: \"scroll\" }}>\r\n                  { this.renderTokenList() }\r\n                </div>\r\n              </Grid>\r\n            :\r\n              <div style={{ height: (window.innerHeight - 300), overflowX: \"hidden\", overflowY: \"scroll\" }}>\r\n                { this.renderFavoriteTokenList(true) }\r\n              </div>\r\n            }\r\n            <Grid container spacing={1} direction=\"row\">\r\n              <Grid item xs={6}>\r\n                { this.state.controlSubMode === \"add\" &&\r\n                  <Button \r\n                    onClick={this.addNewFavorite} \r\n                    variant=\"contained\" color=\"primary\"\r\n                    disabled={ this.state.tokenName === \"\" || this.state.selectedToken === null } \r\n                  >\r\n                    Add New Favorite\r\n                  </Button>\r\n                }\r\n              </Grid>\r\n              <Grid item xs={6}>\r\n                <Button \r\n                  onClick={() => {\r\n                    this.setState({ controlMode: \"main\" });\r\n                  }} \r\n                  variant=\"contained\" color=\"primary\"\r\n                >\r\n                  Close\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n          </ControlsContainer>\r\n        );\r\n      } else {\r\n        return (\r\n          <ControlsContainer key=\"controls\">\r\n            <div onClick={this.zoomIn}>\r\n              <Icons>+</Icons>\r\n            </div>\r\n            <div onClick={this.zoomOut}>\r\n              <Icons>-</Icons>\r\n            </div>\r\n            <div onClick={this.clearSelectAndHover}>\r\n              {this.state.mapMode === \"pan\" ? \"P\" : \"M\"}\r\n            </div>\r\n            <div onClick={() => { this.setState({ controlMode: \"tokens\", controlSubMode: \"add\" }); }}>\r\n              T\r\n            </div>\r\n            <div onClick={() => { this.setState({ controlMode: \"masks\", controlSubMode: \"light\" }); }}>\r\n              L\r\n            </div>\r\n            <div onClick={() => { this.setState({ controlMode: \"favorites\", controlSubMode: \"add\" }); }}>\r\n              F\r\n            </div>\r\n          </ControlsContainer>\r\n        );\r\n      }\r\n    } else {\r\n      return (<div key=\"controls\"></div>);\r\n    }\r\n  };\r\n\r\n  onKeyDown = (e: any) => {\r\n    // Change heldKeys to be individual ones like shiftHeld, ctrlHeld, etc.\r\n    // Because there are only a few holds I'll care about.\r\n    // I do however want to make it respond to some other keys.\r\n    // \r\n    // const heldKeys = this.state.heldKeys.filter(k => k !== e.key);\r\n    // heldKeys.push(e.key);\r\n    // this.setState({ heldKeys });\r\n    if (e.key === \"Shift\") {\r\n      if (!this.state.shiftHeld) {\r\n        // Shift allows adding and removing selected items.\r\n        // If it's not held then clicking while hovering will select that\r\n        // item and deselect all others (unless it's the only one selected,\r\n        // then it will deselect it).\r\n        this.setState({ shiftHeld: true });\r\n      }\r\n    } else if (e.key === \"Control\") {\r\n      if (!this.state.ctrlHeld) {\r\n        // Currently I don't know what I want to do for ctrl.\r\n        // I'll probably have a use for it, so I'll track it being held for now\r\n        this.setState({ ctrlHeld: true });\r\n      }\r\n    } else if (e.key === \"Alt\") {\r\n      this.clearSelectAndHover();\r\n    } else if (e.key === \"w\") {\r\n      this.slideSelected(0, -1);\r\n    } else if (e.key === \"a\") {\r\n      this.slideSelected(-1, 0);\r\n    } else if (e.key === \"s\") {\r\n      this.slideSelected(0, 1);\r\n    } else if (e.key === \"d\") {\r\n      this.slideSelected(1, 0);\r\n    } else {\r\n      console.log(e);\r\n    }\r\n  }\r\n\r\n  slideSelected = (xChange: number, yChange: number) => {\r\n    const newPlayMap = this.props.selectedPlayMap;\r\n    this.state.selected.forEach((s: PlayToken | MaskPoint) => {\r\n      if (s instanceof PlayToken) {\r\n        const selToken: PlayToken = s;\r\n        const tokenFinder = newPlayMap.tokens.filter(t => t.id === selToken.id);\r\n        if (tokenFinder.length === 1) {\r\n          const theToken = tokenFinder[0];\r\n          theToken.x += xChange;\r\n          theToken.y += yChange;\r\n        }\r\n      } else if (s instanceof MaskPoint) {\r\n        const selPoint: MaskPoint = s;\r\n        if (selPoint.maskType === \"light\") {\r\n          const maskFinder = newPlayMap.lightMasks.filter(l => l.id === selPoint.maskID);\r\n          if (maskFinder.length === 1) {\r\n            const theMask = maskFinder[0];\r\n            const pointFinder = theMask.points.filter(p => p.id === selPoint.id);\r\n            if (pointFinder.length === 1) {\r\n              const thePoint = pointFinder[0];\r\n              thePoint.x += xChange;\r\n              thePoint.y += yChange;\r\n            }\r\n          }\r\n        } else if (selPoint.maskType === \"dark\") {\r\n          const maskFinder = newPlayMap.darkMasks.filter(l => l.id === selPoint.maskID);\r\n          if (maskFinder.length === 1) {\r\n            const theMask = maskFinder[0];\r\n            const pointFinder = theMask.points.filter(p => p.id === selPoint.id);\r\n            if (pointFinder.length === 1) {\r\n              const thePoint = pointFinder[0];\r\n              thePoint.x += xChange;\r\n              thePoint.y += yChange;\r\n            }\r\n          }\r\n        } else if (selPoint.maskType === \"fog\") {\r\n          const maskFinder = newPlayMap.fogMasks.filter(l => l.id === selPoint.maskID);\r\n          if (maskFinder.length === 1) {\r\n            const theMask = maskFinder[0];\r\n            const pointFinder = theMask.points.filter(p => p.id === selPoint.id);\r\n            if (pointFinder.length === 1) {\r\n              const thePoint = pointFinder[0];\r\n              thePoint.x += xChange;\r\n              thePoint.y += yChange;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    });\r\n    this.props.updatePlayMap(newPlayMap);\r\n    this.setState({\r\n      lastRefresh: new Date()\r\n    });\r\n  }\r\n\r\n  onKeyUp = (e: any) => {\r\n    if (e.key === \"Shift\") {\r\n      if (this.state.shiftHeld) {\r\n        // Shift allows adding and removing selected items.\r\n        // If it's not held then clicking while hovering will select that\r\n        // item and deselect all others (unless it's the only one selected,\r\n        // then it will deselect it).\r\n        this.setState({ shiftHeld: false });\r\n      }\r\n    } else if (e.key === \"Control\") {\r\n      if (this.state.ctrlHeld) {\r\n        // Currently I don't know what I want to do for ctrl.\r\n        // I'll probably have a use for it, so I'll track it being held for now\r\n        this.setState({ ctrlHeld: false });\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const StyledReactPanZoom = styled(ReactPanZoom)`\r\n      ${Container};\r\n    `;\r\n    return [\r\n      this.renderControls(),\r\n      <StyledReactPanZoom key=\"main\"\r\n        zoom={this.props.selectedPlayMap.zoom}\r\n        pandx={this.props.selectedPlayMap.dx}\r\n        pandy={this.props.selectedPlayMap.dy}\r\n        onPan={this.onPan}\r\n        onClick={this.onClick}\r\n        enableClick={this.state.mapMode === \"move\"}\r\n      >\r\n        <div style={{\r\n            position: \"relative\", \r\n            left: ((-1 * window.innerWidth / 2) + 0), \r\n            top: ((-1 * window.innerHeight / 2) + 25)\r\n          }}>\r\n          { this.props.mode === \"DM\" ? // This is the image that goes behind the main map.  The lightMask clipPath.\r\n            <img style={{\r\n                position: \"absolute\", // The 0.4s are to account for the offsets.  I should make these part of the map object.\r\n                left: (this.props.selectedPlayMap.map.gridWidth) * -25 + (window.innerWidth / 2),\r\n                top: (this.props.selectedPlayMap.map.gridHeight) * -25 + (window.innerHeight / 2) - 25,\r\n                opacity: 0.5,\r\n                width: (this.props.selectedPlayMap.map.gridWidth * 50),\r\n                height: (this.props.selectedPlayMap.map.gridHeight * 50)\r\n              }} \r\n              src={this.props.selectedPlayMap.map.file} alt=\"Fog of War\" \r\n            />\r\n          :\r\n            <img style={{\r\n                position: \"absolute\", // The 0.4s are to account for the offsets.  I should make these part of the map object.\r\n                left: (this.props.selectedPlayMap.map.gridWidth) * -25 + (window.innerWidth / 2),\r\n                top: (this.props.selectedPlayMap.map.gridHeight) * -25 + (window.innerHeight / 2) - 25,\r\n                width: this.props.selectedPlayMap.map.gridWidth * 50,\r\n                height: this.props.selectedPlayMap.map.gridHeight * 50\r\n              }} \r\n              src={FogOfWar} alt=\"Fog of War\" \r\n            />\r\n          }\r\n          <img style={{\r\n              position: \"absolute\", // The 0.4s are to account for the offsets.  I should make these part of the map object.\r\n              left: (this.props.selectedPlayMap.map.gridWidth) * -25 + (window.innerWidth / 2),\r\n              top: (this.props.selectedPlayMap.map.gridHeight) * -25 + (window.innerHeight / 2) - 25,\r\n              width: (this.props.selectedPlayMap.map.gridWidth * 50),\r\n              height: (this.props.selectedPlayMap.map.gridHeight * 50),\r\n              clipPath: \"url(#lightMask)\"\r\n            }}\r\n            src={this.props.selectedPlayMap.map.file} alt=\"Light Mask\" \r\n          />\r\n          {/* <svg width=\"0\" height=\"0\">\r\n            <defs>\r\n              <clipPath id=\"lightMask\">\r\n                <polygon points=\"13,13 13,113 113,113 113,13\"/>\r\n                <polygon points=\"450,10 500,200 600,100\" />\r\n                <polygon points=\"150,10 100,200 300,100\" />\r\n              </clipPath>\r\n            </defs>\r\n          </svg> */}\r\n          <svg width=\"0\" height=\"0\">\r\n            <defs>\r\n              <clipPath id=\"lightMask\">\r\n              { this.props.selectedPlayMap.lightMasks.map((mask, key) => {\r\n                return (\r\n                  <polygon key={key} points={mask.toClipPath(this.props.selectedPlayMap.map.gridWidth, this.props.selectedPlayMap.map.gridHeight)} />\r\n                );\r\n              })}\r\n              </clipPath>\r\n            </defs>\r\n          </svg>\r\n          <svg width=\"0\" height=\"0\">\r\n            <defs>\r\n              <clipPath id=\"darkMask\">\r\n              { this.props.selectedPlayMap.darkMasks.map((mask, key) => {\r\n                return (\r\n                  <polygon key={key} points={mask.toClipPath(this.props.selectedPlayMap.map.gridWidth, this.props.selectedPlayMap.map.gridHeight)} />\r\n                );\r\n              })}\r\n              </clipPath>\r\n            </defs>\r\n          </svg>\r\n          <svg width=\"0\" height=\"0\">\r\n            <defs>\r\n              <clipPath id=\"fogMask\">\r\n              { this.props.selectedPlayMap.fogMasks.map((mask, key) => {\r\n                return (\r\n                  <polygon key={key} points={mask.toClipPath(this.props.selectedPlayMap.map.gridWidth, this.props.selectedPlayMap.map.gridHeight)} />\r\n                );\r\n              })}\r\n              </clipPath>\r\n            </defs>\r\n          </svg>\r\n          { this.props.mode === \"DM\" && \r\n            <img style={{\r\n                position: \"absolute\", // The 0.4s are to account for the offsets.  I should make these part of the map object.\r\n                left: (this.props.selectedPlayMap.map.gridWidth) * -25 + (window.innerWidth / 2),\r\n                top: (this.props.selectedPlayMap.map.gridHeight) * -25 + (window.innerHeight / 2) - 25,\r\n                width: (this.props.selectedPlayMap.map.gridWidth * 50),\r\n                height: (this.props.selectedPlayMap.map.gridHeight * 50),\r\n                clipPath: \"url(#fogMask)\"\r\n              }}\r\n              src={FogOfWar} alt=\"Fog Mask 1\" \r\n            />\r\n          }\r\n          { this.props.mode === \"DM\" && \r\n            <img style={{\r\n                position: \"absolute\", // The 0.4s are to account for the offsets.  I should make these part of the map object.\r\n                left: (this.props.selectedPlayMap.map.gridWidth) * -25 + (window.innerWidth / 2),\r\n                top: (this.props.selectedPlayMap.map.gridHeight) * -25 + (window.innerHeight / 2) - 25,\r\n                width: (this.props.selectedPlayMap.map.gridWidth * 50),\r\n                height: (this.props.selectedPlayMap.map.gridHeight * 50),\r\n                opacity: 0.3,\r\n                clipPath: \"url(#fogMask)\"\r\n              }}\r\n              src={this.props.selectedPlayMap.map.file} alt=\"Fog Mask 2\" \r\n            />\r\n          }\r\n          { this.props.mode === \"DM\" && \r\n            <img style={{\r\n                position: \"absolute\", // The 0.4s are to account for the offsets.  I should make these part of the map object.\r\n                left: (this.props.selectedPlayMap.map.gridWidth) * -25 + (window.innerWidth / 2),\r\n                top: (this.props.selectedPlayMap.map.gridHeight) * -25 + (window.innerHeight / 2) - 25,\r\n                width: (this.props.selectedPlayMap.map.gridWidth * 50),\r\n                height: (this.props.selectedPlayMap.map.gridHeight * 50),\r\n                opacity: 0.7,\r\n                clipPath: \"url(#darkMask)\"\r\n              }}\r\n              src={FogOfWar} alt=\"Dark Mask\" \r\n            />\r\n          }\r\n          { this.props.selectedPlayMap.tokens.map((t, key) => {\r\n            return (\r\n              <div key={key} style={{\r\n                position: \"absolute\",\r\n                left: t.x * 50 + (window.innerWidth / 2) - 25 - (t.size * 25),\r\n                top: t.y * 50 + (window.innerHeight / 2) - 25 - (t.size * 25),\r\n                width: t.size * 50,\r\n                height: t.size * 50,\r\n                backgroundColor: (this.state.selected.includes(t) ? \"blue\" : \"transparent\"),\r\n                borderRadius: (t.size * 25)\r\n              }}\r\n              onMouseEnter={() => {\r\n                this.setState({ hovered: t });\r\n              }}\r\n              onMouseLeave={() => {\r\n                this.setState({ hovered: null });\r\n              }}>\r\n                <img src={t.token.file} alt=\"testing\" \r\n                  style={{\r\n                    width: t.size * 50,\r\n                    height: t.size * 50\r\n                  }}\r\n                />\r\n                <span style={{ color: \"black\", fontWeight: \"bold\" }}>{t.name}</span>\r\n              </div>\r\n            );\r\n          })}\r\n          { this.props.mode !== \"DM\" && \r\n            <img style={{\r\n                position: \"absolute\", // The 0.4s are to account for the offsets.  I should make these part of the map object.\r\n                left: (this.props.selectedPlayMap.map.gridWidth) * -25 + (window.innerWidth / 2),\r\n                top: (this.props.selectedPlayMap.map.gridHeight) * -25 + (window.innerHeight / 2) - 25,\r\n                width: (this.props.selectedPlayMap.map.gridWidth * 50),\r\n                height: (this.props.selectedPlayMap.map.gridHeight * 50),\r\n                clipPath: \"url(#fogMask)\"\r\n              }}\r\n              src={FogOfWar} alt=\"Fog Mask 1\" \r\n            />\r\n          }\r\n          { this.props.mode !== \"DM\" && \r\n            <img style={{\r\n                position: \"absolute\", // The 0.4s are to account for the offsets.  I should make these part of the map object.\r\n                left: (this.props.selectedPlayMap.map.gridWidth) * -25 + (window.innerWidth / 2),\r\n                top: (this.props.selectedPlayMap.map.gridHeight) * -25 + (window.innerHeight / 2) - 25,\r\n                width: (this.props.selectedPlayMap.map.gridWidth * 50),\r\n                height: (this.props.selectedPlayMap.map.gridHeight * 50),\r\n                opacity: 0.5,\r\n                clipPath: \"url(#fogMask)\"\r\n              }}\r\n              src={this.props.selectedPlayMap.map.file} alt=\"Fog Mask 2\" \r\n            />\r\n          }\r\n          { this.props.mode !== \"DM\" && \r\n            <img style={{\r\n                position: \"absolute\", // The 0.4s are to account for the offsets.  I should make these part of the map object.\r\n                left: (this.props.selectedPlayMap.map.gridWidth) * -25 + (window.innerWidth / 2),\r\n                top: (this.props.selectedPlayMap.map.gridHeight) * -25 + (window.innerHeight / 2) - 25,\r\n                width: (this.props.selectedPlayMap.map.gridWidth * 50),\r\n                height: (this.props.selectedPlayMap.map.gridHeight * 50),\r\n                clipPath: \"url(#darkMask)\"\r\n              }}\r\n              src={FogOfWar} alt=\"Dark Mask\" \r\n            />\r\n          }\r\n          { this.props.mode === \"DM\" && this.props.selectedPlayMap.lightMasks.map((mask, mkey) => {\r\n            return (\r\n              <div key={mkey}>\r\n                { mask.points.map((p, pkey) => {\r\n                  return (\r\n                    <div key={pkey} style={{\r\n                      position: \"absolute\",\r\n                      left: p.x * 50 + (window.innerWidth / 2) - 60,\r\n                      top: p.y * 50 + (window.innerHeight / 2) - 60,\r\n                      width: 20,\r\n                      height: 20,\r\n                      backgroundColor: (this.state.selected.includes(p) ? \"green\" : \"yellow\"),\r\n                      borderRadius: (5)\r\n                    }}\r\n                    onMouseEnter={() => {\r\n                      this.setState({ hovered: p });\r\n                    }}\r\n                    onMouseLeave={() => {\r\n                      this.setState({ hovered: null });\r\n                    }}>\r\n                      {p.id}\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            );\r\n          })}\r\n          { this.props.mode === \"DM\" && this.props.selectedPlayMap.darkMasks.map((mask, mkey) => {\r\n            return (\r\n              <div key={mkey}>\r\n                { mask.points.map((p, pkey) => {\r\n                  return (\r\n                    <div key={pkey} style={{\r\n                      position: \"absolute\",\r\n                      left: p.x * 50 + (window.innerWidth / 2) - 60,\r\n                      top: p.y * 50 + (window.innerHeight / 2) - 60,\r\n                      width: 20,\r\n                      height: 20,\r\n                      backgroundColor: (this.state.selected.includes(p) ? \"green\" : \"purple\"),\r\n                      borderRadius: (5)\r\n                    }}\r\n                    onMouseEnter={() => {\r\n                      this.setState({ hovered: p });\r\n                    }}\r\n                    onMouseLeave={() => {\r\n                      this.setState({ hovered: null });\r\n                    }}>\r\n                      {p.id}\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            );\r\n          })}\r\n          { this.props.mode === \"DM\" && this.props.selectedPlayMap.fogMasks.map((mask, mkey) => {\r\n            return (\r\n              <div key={mkey}>\r\n                { mask.points.map((p, pkey) => {\r\n                  return (\r\n                    <div key={pkey} style={{\r\n                      position: \"absolute\",\r\n                      left: p.x * 50 + (window.innerWidth / 2) - 60,\r\n                      top: p.y * 50 + (window.innerHeight / 2) - 60,\r\n                      width: 20,\r\n                      height: 20,\r\n                      backgroundColor: (this.state.selected.includes(p) ? \"green\" : \"grey\"),\r\n                      borderRadius: (5)\r\n                    }}\r\n                    onMouseEnter={() => {\r\n                      this.setState({ hovered: p });\r\n                    }}\r\n                    onMouseLeave={() => {\r\n                      this.setState({ hovered: null });\r\n                    }}>\r\n                      {p.id}\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </StyledReactPanZoom>\r\n    ];\r\n  }\r\n}\r\n\r\nexport default connector(DisplayPlayMap);\r\n","import React, { Component } from \"react\";\r\nimport { connect, ConnectedProps } from 'react-redux';\r\nimport styled\r\n// , { css } \r\nfrom \"styled-components\";\r\nimport {\r\n  Button\r\n} from \"@material-ui/core\";\r\nimport { PlayMap } from \"../models/PlayMap\";\r\n// import { PlayToken } from \"../models/PlayToken\";\r\nimport { Token } from \"../models/Token\";\r\n// import ReactPanZoom from \"../components/my-react-pan-zoom\";\r\nimport CreatePlayMap from \"../components/CreatePlayMap\";\r\nimport LoadPlayMap from \"../components/LoadPlayMap\";\r\nimport DisplayPlayMap from \"../components/DisplayPlayMap\";\r\n// import ReduxTest from \"../components/ReduxTest\";\r\n// import SVGTest from \"../components/SVGTest\";\r\nimport API from \"../smartAPI\";\r\n\r\nconst HEADER_HEIGHT = 50;\r\n// const Container = css`\r\n//   height: calc(100vh - ${HEADER_HEIGHT}px);\r\n//   width: 100vw;\r\n//   overflow: hidden;\r\n//   display: flex;\r\n//   justify-content: center;\r\n//   align-items: center;\r\n//   z-index: 1;\r\n// `;\r\n// const ControlsContainer = styled.div`\r\n//   position: fixed;\r\n//   background: lightgray;\r\n//   height: 100%;\r\n//   right: 0;\r\n//   z-index: 2;\r\n//   cursor: pointer;\r\n//   user-select: none;\r\n\r\n//   > div {\r\n//     padding: 15px;\r\n//     &:hover {\r\n//       background: darkgray;\r\n//     }\r\n//     &:active {\r\n//       box-shadow: 1px 1px 1px inset;\r\n//     }\r\n//   }\r\n// `;\r\n\r\nconst Heading = styled.div`\r\n  background: dimgrey;\r\n  color: white;\r\n  height: ${HEADER_HEIGHT}px;\r\n  display: flex;\r\n  align-items: center;\r\n  padding-left: 10px;\r\n`;\r\n\r\n// const Icons = styled.strong`\r\n//   font-size: 2rem;\r\n// `;\r\n\r\n// const mapStateToProps = state => {\r\n//   return {\r\n//     // width: state.app.width\r\n//   };\r\n// };\r\n// function mapDispatchToProps(dispatch) {\r\n//   return {\r\n//     // notFromLogin: () => dispatch(notFromLogin({}))\r\n//   };\r\n// }\r\n\r\ninterface AppState {\r\n  tokens: Token[],\r\n  selectedPlayMap: PlayMap\r\n}\r\n\r\ninterface RootState {\r\n  app: AppState\r\n}\r\n\r\nconst mapState = (state: RootState) => ({\r\n  tokens: state.app.tokens,\r\n  selectedPlayMap: state.app.selectedPlayMap\r\n});\r\n\r\nconst mapDispatch = {\r\n  // setMaps: (maps: Map[]) => ({ type: 'SET_MAPS', payload: maps }),\r\n  // setPlayMaps: (playMaps: PlayMap[]) => ({ type: 'SET_PLAYMAPS', payload: playMaps }),\r\n  // addPlayMap: (playMap: PlayMap) => ({ type: 'ADD_PLAYMAP', payload: playMap }),\r\n  selectPlayMap: (playMap: PlayMap) => ({ type: 'SELECT_PLAYMAP', payload: playMap }),\r\n  updatePlayMap: (playMap: PlayMap) => ({ type: 'UPDATE_PLAYMAP', payload: playMap })\r\n}\r\n\r\nconst connector = connect(mapState, mapDispatch)\r\n\r\ntype PropsFromRedux = ConnectedProps<typeof connector>\r\n\r\ntype Props = PropsFromRedux & {\r\n}\r\nexport interface IDMPageStateType {\r\n  mode: string;\r\n  selectedTokenID: number;\r\n  hoveredTokenID: number;\r\n  deselecting: boolean;\r\n}\r\nclass DMPage extends Component<\r\n  Props,\r\n  IDMPageStateType\r\n> {\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.state = {\r\n      mode: \"load\",\r\n      selectedTokenID: -1,\r\n      hoveredTokenID: -1,\r\n      deselecting: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  api: any;\r\n\r\n  componentDidMount() {}\r\n\r\n  createPlayMap = () => {\r\n    this.setState({\r\n      mode: \"create\"\r\n    })\r\n  }\r\n\r\n  loadPlayMap = () => {\r\n    this.setState({\r\n      mode: \"load\"\r\n    })\r\n  }\r\n\r\n  savePlayMap = () => {\r\n    this.api.updatePlayMap(this.props.selectedPlayMap.toDBObj()).then(() => {\r\n    });\r\n  }\r\n\r\n  selectPlayMap = (playMap: PlayMap) => {\r\n    this.props.selectPlayMap(playMap);\r\n    this.setState({ mode: \"main\" });\r\n  }\r\n\r\n  renderHeader = () => {\r\n    return (\r\n      <Heading key=\"heading\"> \r\n        Dead Simple VTT - DM Page \r\n        <Button onClick={this.createPlayMap}>Create PlayMap</Button>\r\n        <Button onClick={this.loadPlayMap}>Load PlayMap</Button>\r\n        <Button onClick={this.savePlayMap} disabled={this.props.selectedPlayMap === null}>Save PlayMap (I'll change this to auto-save later)</Button>\r\n      </Heading>\r\n    );\r\n  };\r\n\r\n  renderMain = () => {\r\n    if (this.state.mode === \"load\") {\r\n      return (\r\n        <LoadPlayMap key=\"main\" mode=\"DM\" selectPlayMap={this.selectPlayMap} />\r\n      );\r\n      // return (\r\n      //   <ReduxTest key=\"main\" backgroundColor=\"red\" />\r\n      // );\r\n      \r\n    //   <style type='text/css'>\r\n    //   div, img { position:absolute; top:0; left:0; width:250px; height:250px; }\r\n    //   img {\r\n    //     -webkit-mask-image:-webkit-gradient(linear, left top, left bottom, from(rgba(0,0,0,1)), to(rgba(0,0,0,0)));\r\n    //     mask-image: linear-gradient(to bottom, rgba(0,0,0,1), rgba(0,0,0,0));\r\n    //   }\r\n    // </style>\r\n      // return (\r\n      //   <div>\r\n      //     <div style={{ position:\"relative\", top:0, left:0, width:250, height:250 }}>\r\n      //       Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi sit amet porttitor massa. Morbi eget tortor congue, aliquet odio a, viverra metus. Ut cursus enim eu felis sollicitudin, vitae eleifend urna lobortis. Mauris elementum erat non facilisis cursus. Fusce sit amet lacus dictum, porta libero sed, euismod tellus. Aenean erat augue, sodales sed gravida ac, imperdiet ac augue. Ut condimentum dictum mauris. Donec tincidunt enim a massa molestie, vel volutpat massa dictum. Donec semper odio vitae adipiscing lacinia.</div>\r\n      //     <img src='https://i.imgur.com/sLa5gg2.jpg' alt='testing'\r\n      //       style={{ \r\n      //         position:\"relative\", top:0, left:0, width:250, height:250,\r\n      //         WebkitMaskImage:\"-webkit-gradient(linear, left top, left bottom, from(rgba(0,0,0,1)), to(rgba(0,0,0,0)))\",\r\n      //         maskImage: \"linear-gradient(to bottom, rgba(0,0,0,1), rgba(0,0,0,0))\"\r\n      //       }} />\r\n      //   </div>\r\n      // );\r\n    } else if (this.state.mode === \"create\") {\r\n      return (\r\n        <CreatePlayMap key=\"main\" selectPlayMap={this.selectPlayMap} />\r\n      );\r\n    } else {\r\n      if (this.props.selectedPlayMap) {\r\n        return (\r\n          <DisplayPlayMap key=\"main\" mode=\"DM\" />\r\n        );\r\n        // const StyledReactPanZoom = styled(ReactPanZoom)`\r\n        //   ${Container};\r\n        // `;\r\n        // return (\r\n        //   <StyledReactPanZoom key=\"main\"\r\n        //     zoom={this.state.playMap.zoom}\r\n        //     pandx={this.state.playMap.dx}\r\n        //     pandy={this.state.playMap.dy}\r\n        //     onPan={this.onPan}\r\n        //     onClick={this.onClick}\r\n        //     enableClick={this.state.mode === \"move\"}\r\n        //   >\r\n        //     <div style={{position: \"relative\", left: ((-1 * window.innerWidth / 2) + 0), top: ((-1 * window.innerHeight / 2) + 25)}}>\r\n        //       <img style={{\r\n        //           position: \"absolute\",\r\n        //           top: 0,\r\n        //           left: 0\r\n        //         }} src=\"https://i.imgur.com/WJ17gs5.jpg\" alt=\"testing\" />\r\n        //       { this.state.playMap.tokens.map((t, key) => {\r\n        //         return (\r\n        //           <div key={key} style={{\r\n        //             position: \"absolute\",\r\n        //             left: t.x + (window.innerWidth / 2) - (t.size * 25),\r\n        //             top: t.y + (window.innerHeight / 2) - 25 - (t.size * 25),\r\n        //             width: t.size * 50,\r\n        //             height: t.size * 50,\r\n        //             backgroundColor: (t.id === this.state.selectedTokenID ? \"blue\" : \"transparent\"),\r\n        //             borderRadius: (t.size * 25)\r\n        //           }}\r\n        //           onMouseEnter={() => {\r\n        //             // console.log(t.id);\r\n        //             this.setState({ hoveredTokenID: t.id });\r\n        //           }}\r\n        //           onMouseLeave={() => {\r\n        //             if (this.state.hoveredTokenID === t.id) {\r\n        //               // console.log(t.id);\r\n        //               this.setState({ hoveredTokenID: -1 });\r\n        //             }\r\n        //           }}>\r\n        //             <img src={t.token.file} alt=\"testing\" \r\n        //               style={{\r\n        //                 width: t.size * 50,\r\n        //                 height: t.size * 50\r\n        //               }}\r\n        //             />\r\n        //           </div>\r\n        //         );\r\n        //       })}\r\n        //     </div>\r\n        //   </StyledReactPanZoom>\r\n        // );\r\n      } else {\r\n        return (\r\n          <div key=\"main\" style={{ margin: 10 }}>\r\n            Load a Map to see it here\r\n          </div>\r\n        );\r\n      }\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return [\r\n      this.renderHeader(),\r\n      this.renderMain()\r\n    ];\r\n  }\r\n}\r\n\r\nexport default connector(DMPage);\r\n","import React, { Component } from \"react\";\r\nimport { connect, ConnectedProps } from 'react-redux';\r\nimport styled\r\n// , { css } \r\nfrom \"styled-components\";\r\nimport {\r\n  Button\r\n} from \"@material-ui/core\";\r\nimport { Map } from \"../models/Map\";\r\nimport { PlayMap } from \"../models/PlayMap\";\r\n// import { PlayToken } from \"../models/PlayToken\";\r\nimport { Token } from \"../models/Token\";\r\n// import { Mask, MaskPoint } from \"../models/Mask\";\r\n// import ReactPanZoom from \"../components/my-react-pan-zoom\";\r\n// import CreatePlayMap from \"../components/CreatePlayMap\";\r\nimport LoadPlayMap from \"../components/LoadPlayMap\";\r\nimport DisplayPlayMap from \"../components/DisplayPlayMap\";\r\n// import ReduxTest from \"../components/ReduxTest\";\r\n// import SVGTest from \"../components/SVGTest\";\r\nimport API from \"../smartAPI\";\r\n\r\nconst HEADER_HEIGHT = 50;\r\n// const Container = css`\r\n//   height: calc(100vh - ${HEADER_HEIGHT}px);\r\n//   width: 100vw;\r\n//   overflow: hidden;\r\n//   display: flex;\r\n//   justify-content: center;\r\n//   align-items: center;\r\n//   z-index: 1;\r\n// `;\r\n// const ControlsContainer = styled.div`\r\n//   position: fixed;\r\n//   background: lightgray;\r\n//   height: 100%;\r\n//   right: 0;\r\n//   z-index: 2;\r\n//   cursor: pointer;\r\n//   user-select: none;\r\n\r\n//   > div {\r\n//     padding: 15px;\r\n//     &:hover {\r\n//       background: darkgray;\r\n//     }\r\n//     &:active {\r\n//       box-shadow: 1px 1px 1px inset;\r\n//     }\r\n//   }\r\n// `;\r\n\r\nconst Heading = styled.div`\r\n  background: dimgrey;\r\n  color: white;\r\n  height: ${HEADER_HEIGHT}px;\r\n  display: flex;\r\n  align-items: center;\r\n  padding-left: 10px;\r\n`;\r\n\r\n// const Icons = styled.strong`\r\n//   font-size: 2rem;\r\n// `;\r\n\r\n// const mapStateToProps = state => {\r\n//   return {\r\n//     // width: state.app.width\r\n//   };\r\n// };\r\n// function mapDispatchToProps(dispatch) {\r\n//   return {\r\n//     // notFromLogin: () => dispatch(notFromLogin({}))\r\n//   };\r\n// }\r\n\r\ninterface AppState {\r\n  tokens: Token[],\r\n  selectedPlayMap: PlayMap,\r\n  maps: Map[]\r\n}\r\n\r\ninterface RootState {\r\n  app: AppState\r\n}\r\n\r\nconst mapState = (state: RootState) => ({\r\n  tokens: state.app.tokens,\r\n  selectedPlayMap: state.app.selectedPlayMap,\r\n  maps: state.app.maps\r\n});\r\n\r\nconst mapDispatch = {\r\n  // setMaps: (maps: Map[]) => ({ type: 'SET_MAPS', payload: maps }),\r\n  // setPlayMaps: (playMaps: PlayMap[]) => ({ type: 'SET_PLAYMAPS', payload: playMaps }),\r\n  // addPlayMap: (playMap: PlayMap) => ({ type: 'ADD_PLAYMAP', payload: playMap }),\r\n  selectPlayMap: (playMap: PlayMap) => ({ type: 'SELECT_PLAYMAP', payload: playMap }),\r\n  updatePlayMap: (playMap: PlayMap) => ({ type: 'UPDATE_PLAYMAP', payload: playMap })\r\n}\r\n\r\nconst connector = connect(mapState, mapDispatch)\r\n\r\ntype PropsFromRedux = ConnectedProps<typeof connector>\r\n\r\ntype Props = PropsFromRedux & {\r\n}\r\nexport interface IPlayerPageStateType {\r\n  mode: string;\r\n  // selectedTokenID: number;\r\n  // hoveredTokenID: number;\r\n  // deselecting: boolean;\r\n  countdown: number;\r\n  refreshing: boolean;\r\n}\r\nclass PlayerPage extends Component<\r\n  Props,\r\n  IPlayerPageStateType\r\n> {\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.state = {\r\n      mode: \"load\",\r\n      // selectedTokenID: -1,\r\n      // hoveredTokenID: -1,\r\n      // deselecting: false\r\n      countdown: -1,\r\n      refreshing: false\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  api: any;\r\n\r\n  componentDidMount() {}\r\n\r\n  loadPlayMap = () => {\r\n    this.setState({\r\n      mode: \"load\"\r\n    })\r\n  }\r\n\r\n  selectPlayMap = (playMap: PlayMap) => {\r\n    this.props.selectPlayMap(playMap);\r\n    this.setState({ mode: \"main\" });\r\n  }\r\n\r\n  renderHeader = () => {\r\n    return (\r\n      <Heading key=\"heading\"> \r\n        Dead Simple VTT\r\n        <Button onClick={this.loadPlayMap}>Load PlayMap</Button>\r\n      </Heading>\r\n    );\r\n  };\r\n\r\n  renderMain = () => {\r\n    if (this.state.mode === \"load\") {\r\n      return (\r\n        <LoadPlayMap key=\"main\" mode=\"player\" selectPlayMap={this.selectPlayMap} />\r\n      );\r\n      // return (\r\n      //   <ReduxTest key=\"main\" backgroundColor=\"red\" />\r\n      // );\r\n      \r\n    //   <style type='text/css'>\r\n    //   div, img { position:absolute; top:0; left:0; width:250px; height:250px; }\r\n    //   img {\r\n    //     -webkit-mask-image:-webkit-gradient(linear, left top, left bottom, from(rgba(0,0,0,1)), to(rgba(0,0,0,0)));\r\n    //     mask-image: linear-gradient(to bottom, rgba(0,0,0,1), rgba(0,0,0,0));\r\n    //   }\r\n    // </style>\r\n      // return (\r\n      //   <div>\r\n      //     <div style={{ position:\"relative\", top:0, left:0, width:250, height:250 }}>\r\n      //       Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi sit amet porttitor massa. Morbi eget tortor congue, aliquet odio a, viverra metus. Ut cursus enim eu felis sollicitudin, vitae eleifend urna lobortis. Mauris elementum erat non facilisis cursus. Fusce sit amet lacus dictum, porta libero sed, euismod tellus. Aenean erat augue, sodales sed gravida ac, imperdiet ac augue. Ut condimentum dictum mauris. Donec tincidunt enim a massa molestie, vel volutpat massa dictum. Donec semper odio vitae adipiscing lacinia.</div>\r\n      //     <img src='https://i.imgur.com/sLa5gg2.jpg' alt='testing'\r\n      //       style={{ \r\n      //         position:\"relative\", top:0, left:0, width:250, height:250,\r\n      //         WebkitMaskImage:\"-webkit-gradient(linear, left top, left bottom, from(rgba(0,0,0,1)), to(rgba(0,0,0,0)))\",\r\n      //         maskImage: \"linear-gradient(to bottom, rgba(0,0,0,1), rgba(0,0,0,0))\"\r\n      //       }} />\r\n      //   </div>\r\n      // );\r\n    } else {\r\n      if (this.props.selectedPlayMap) {\r\n        return (\r\n          <DisplayPlayMap key=\"main\" mode=\"Player\" />\r\n        );\r\n        // const StyledReactPanZoom = styled(ReactPanZoom)`\r\n        //   ${Container};\r\n        // `;\r\n        // return (\r\n        //   <StyledReactPanZoom key=\"main\"\r\n        //     zoom={this.state.playMap.zoom}\r\n        //     pandx={this.state.playMap.dx}\r\n        //     pandy={this.state.playMap.dy}\r\n        //     onPan={this.onPan}\r\n        //     onClick={this.onClick}\r\n        //     enableClick={this.state.mode === \"move\"}\r\n        //   >\r\n        //     <div style={{position: \"relative\", left: ((-1 * window.innerWidth / 2) + 0), top: ((-1 * window.innerHeight / 2) + 25)}}>\r\n        //       <img style={{\r\n        //           position: \"absolute\",\r\n        //           top: 0,\r\n        //           left: 0\r\n        //         }} src=\"https://i.imgur.com/WJ17gs5.jpg\" alt=\"testing\" />\r\n        //       { this.state.playMap.tokens.map((t, key) => {\r\n        //         return (\r\n        //           <div key={key} style={{\r\n        //             position: \"absolute\",\r\n        //             left: t.x + (window.innerWidth / 2) - (t.size * 25),\r\n        //             top: t.y + (window.innerHeight / 2) - 25 - (t.size * 25),\r\n        //             width: t.size * 50,\r\n        //             height: t.size * 50,\r\n        //             backgroundColor: (t.id === this.state.selectedTokenID ? \"blue\" : \"transparent\"),\r\n        //             borderRadius: (t.size * 25)\r\n        //           }}\r\n        //           onMouseEnter={() => {\r\n        //             // console.log(t.id);\r\n        //             this.setState({ hoveredTokenID: t.id });\r\n        //           }}\r\n        //           onMouseLeave={() => {\r\n        //             if (this.state.hoveredTokenID === t.id) {\r\n        //               // console.log(t.id);\r\n        //               this.setState({ hoveredTokenID: -1 });\r\n        //             }\r\n        //           }}>\r\n        //             <img src={t.token.file} alt=\"testing\" \r\n        //               style={{\r\n        //                 width: t.size * 50,\r\n        //                 height: t.size * 50\r\n        //               }}\r\n        //             />\r\n        //           </div>\r\n        //         );\r\n        //       })}\r\n        //     </div>\r\n        //   </StyledReactPanZoom>\r\n        // );\r\n      } else {\r\n        return (\r\n          <div key=\"main\" style={{ margin: 10 }}>\r\n            Load a Map to see it here\r\n          </div>\r\n        );\r\n      }\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return [\r\n      this.renderHeader(),\r\n      this.renderMain()\r\n    ];\r\n  }\r\n}\r\n\r\nexport default connector(PlayerPage);\r\n","\r\nimport BasementStudy from \"../assets/img/maps/Basement-Study.jpg\";\r\nimport CastleWall from \"../assets/img/maps/Castle-Wall.jpg\";\r\nimport CaveLair from \"../assets/img/maps/Cave-Lair.jpg\";\r\nimport Crossroads from \"../assets/img/maps/Crossroads.jpg\";\r\nimport Farmstead from \"../assets/img/maps/Farmstead.jpg\";\r\nimport ForestLair from \"../assets/img/maps/Forest-Lair.jpg\";\r\nimport MonsterLair from \"../assets/img/maps/Monster-Lair.jpg\";\r\nimport SnowVillage from \"../assets/img/maps/Snow-Village.jpg\";\r\nimport SwampLair from \"../assets/img/maps/Swamp-Lair.jpg\";\r\nimport Tavern from \"../assets/img/maps/Tavern.jpg\";\r\nimport UndergroundComplex from \"../assets/img/maps/Underground-Complex.jpg\";\r\nimport UrbanLair from \"../assets/img/maps/Urban-Lair.jpg\";\r\nimport WagonTrailandShrine from \"../assets/img/maps/Wagon-Trail-and-Shrine.jpg\";\r\nimport WaterfallCavern from \"../assets/img/maps/Waterfall-Cavern.jpg\";\r\nimport AbandonedWarehouse from \"../assets/img/maps/AbandonedWarehouse.png\";\r\nimport DaggerAlley from \"../assets/img/maps/DaggerAlley.png\";\r\nimport UnderDaggerAlley from \"../assets/img/maps/UnderDaggerAlley.png\";\r\nimport TrollSkullAlleyBasement from \"../assets/img/maps/TrollSkullAlleyBasement.png\";\r\nimport TrollSkullAlleyHouse from \"../assets/img/maps/TrollSkullAlleyHouse.png\";\r\nimport WeddingRing from \"../assets/img/maps/WeddingRing.png\";\r\n\r\ninterface IHash {\r\n  [details: string] : string;\r\n} \r\nconst MapFile: IHash = {\r\n  BasementStudy: BasementStudy,\r\n  CastleWall: CastleWall,\r\n  CaveLair: CaveLair,\r\n  Crossroads: Crossroads,\r\n  Farmstead: Farmstead,\r\n  ForestLair: ForestLair,\r\n  MonsterLair: MonsterLair,\r\n  SnowVillage: SnowVillage,\r\n  SwampLair: SwampLair,\r\n  Tavern: Tavern,\r\n  UndergroundComplex: UndergroundComplex,\r\n  UrbanLair: UrbanLair,\r\n  WagonTrailandShrine: WagonTrailandShrine,\r\n  WaterfallCavern: WaterfallCavern,\r\n  AbandonedWarehouse: AbandonedWarehouse,\r\n  DaggerAlley: DaggerAlley,\r\n  UnderDaggerAlley: UnderDaggerAlley,\r\n  TrollSkullAlleyBasement: TrollSkullAlleyBasement,\r\n  TrollSkullAlleyHouse: TrollSkullAlleyHouse,\r\n  WeddingRing: WeddingRing\r\n};\r\n\r\nexport class Map {\r\n  _id: string;\r\n  name: string;\r\n  file: string;\r\n  gridWidth: number;\r\n  gridHeight: number;\r\n\r\n  constructor(\r\n    _id: string, \r\n    name: string,\r\n    fileName: string, \r\n    width: number, \r\n    height: number) {\r\n    this._id = _id;\r\n    this.name = name;\r\n    this.file = MapFile[fileName];\r\n    this.gridWidth = width;\r\n    this.gridHeight = height;\r\n  }\r\n}","\r\nimport Bald from \"../assets/img/tokens/Bald.png\";\r\nimport Bard from \"../assets/img/tokens/Bard.png\";\r\nimport BlondeHair from \"../assets/img/tokens/BlondeHair.png\";\r\nimport BlondeWoman from \"../assets/img/tokens/BlondeWoman.png\";\r\nimport BlueSkin from \"../assets/img/tokens/BlueSkin.png\";\r\nimport BlueSkin2 from \"../assets/img/tokens/BlueSkin2.png\";\r\nimport DarkSkin from \"../assets/img/tokens/DarkSkin.png\";\r\nimport DarkSkinF from \"../assets/img/tokens/DarkSkinF.png\";\r\nimport Dragonborn from \"../assets/img/tokens/Dragonborn.png\";\r\nimport DragonbornFighter from \"../assets/img/tokens/DragonbornFighter.png\";\r\nimport DwarfMale from \"../assets/img/tokens/DwarfMale.png\";\r\nimport ElvenFemale from \"../assets/img/tokens/ElvenFemale.png\";\r\nimport ElvenFighter from \"../assets/img/tokens/ElvenFighter.png\";\r\nimport Eyebrows from \"../assets/img/tokens/Eyebrows.png\";\r\nimport Eyebrows2 from \"../assets/img/tokens/Eyebrows2.png\";\r\nimport Fedora from \"../assets/img/tokens/Fedora.png\";\r\nimport GnomeMale from \"../assets/img/tokens/GnomeMale.png\";\r\nimport GoliathBarb from \"../assets/img/tokens/GoliathBarb.png\";\r\nimport GreyHair from \"../assets/img/tokens/GreyHair.png\";\r\nimport HalflingMale from \"../assets/img/tokens/HalflingMale.png\";\r\nimport Hood from \"../assets/img/tokens/Hood.png\";\r\nimport Hood2 from \"../assets/img/tokens/Hood2.png\";\r\nimport Human from \"../assets/img/tokens/Human.png\";\r\nimport HumanFemale from \"../assets/img/tokens/HumanFemale.png\";\r\nimport HumanFemale2 from \"../assets/img/tokens/HumanFemale2.png\";\r\nimport HumanFighterF from \"../assets/img/tokens/HumanFighterF.png\";\r\nimport HumanFighterM from \"../assets/img/tokens/HumanFighterM.png\";\r\nimport HumanMale from \"../assets/img/tokens/HumanMale.png\";\r\nimport HumanMale2 from \"../assets/img/tokens/HumanMale2.png\";\r\nimport IDK from \"../assets/img/tokens/idk.png\";\r\nimport Knight from \"../assets/img/tokens/Knight.png\";\r\nimport OldWoman from \"../assets/img/tokens/OldWoman.png\";\r\nimport OldWoman2 from \"../assets/img/tokens/OldWoman2.png\";\r\nimport RedHair from \"../assets/img/tokens/RedHair.png\";\r\nimport RedSkin from \"../assets/img/tokens/RedSkin.png\";\r\nimport Samurai from \"../assets/img/tokens/Samurai.png\";\r\nimport Scarf from \"../assets/img/tokens/Scarf.png\";\r\nimport TieflingFemale from \"../assets/img/tokens/TieflingFemale.png\";\r\nimport Wizard from \"../assets/img/tokens/Wizard.png\";\r\nimport Rat from \"../assets/img/tokens/Rat.png\";\r\nimport Wererat from \"../assets/img/tokens/Wererat.png\";\r\nimport Werewolf from \"../assets/img/tokens/Werewolf.png\";\r\nimport RugOfSmothering from \"../assets/img/tokens/RugOfSmothering.jpeg\";\r\nimport PitTrapWSpikes from \"../assets/img/tokens/PitTrapWSpikes.png\";\r\n\r\ninterface IHash {\r\n  [details: string] : string;\r\n} \r\nconst TokenFile: IHash = {\r\n  Bald: Bald,\r\n  Bard: Bard,\r\n  BlondeHair: BlondeHair,\r\n  BlondeWoman: BlondeWoman,\r\n  BlueSkin: BlueSkin,\r\n  BlueSkin2: BlueSkin2,\r\n  DarkSkin: DarkSkin,\r\n  DarkSkinF: DarkSkinF,\r\n  Dragonborn: Dragonborn,\r\n  DragonbornFighter: DragonbornFighter,\r\n  DwarfMale: DwarfMale,\r\n  ElvenFemale: ElvenFemale,\r\n  ElvenFighter: ElvenFighter,\r\n  Eyebrows: Eyebrows,\r\n  Eyebrows2: Eyebrows2,\r\n  Fedora: Fedora,\r\n  GnomeMale: GnomeMale,\r\n  GoliathBarb: GoliathBarb,\r\n  GreyHair: GreyHair,\r\n  HalflingMale: HalflingMale,\r\n  Hood: Hood,\r\n  Hood2: Hood2,\r\n  Human: Human,\r\n  HumanFemale: HumanFemale,\r\n  HumanFemale2: HumanFemale2,\r\n  HumanFighterF: HumanFighterF,\r\n  HumanFighterM: HumanFighterM,\r\n  HumanMale: HumanMale,\r\n  HumanMale2: HumanMale2,\r\n  IDK: IDK,\r\n  Knight: Knight,\r\n  OldWoman: OldWoman,\r\n  OldWoman2: OldWoman2,\r\n  RedHair: RedHair,\r\n  RedSkin: RedSkin,\r\n  Samurai: Samurai,\r\n  Scarf: Scarf,\r\n  TieflingFemale: TieflingFemale,\r\n  Wizard: Wizard,\r\n  Rat: Rat,\r\n  Wererat: Wererat,\r\n  Werewolf: Werewolf,\r\n  RugOfSmothering: RugOfSmothering,\r\n  PitTrapWSpikes: PitTrapWSpikes\r\n};\r\n\r\nexport class Token {\r\n  _id: string;\r\n  file: string;\r\n\r\n  constructor(\r\n    _id: string, \r\n    fileName: string) {\r\n    this._id = _id;\r\n    this.file = TokenFile[fileName];\r\n  }\r\n}","import React, { Component } from \"react\";\r\n// import { Redirect } from \"react-router-dom\";\r\nimport { connect, ConnectedProps } from 'react-redux';\r\nimport { \r\n  Route, \r\n  Switch } from \"react-router-dom\";\r\n  // import { connect } from \"react-redux\";\r\nimport HomePage from \"./Home\";\r\nimport DMPage from \"./DM\";\r\nimport PlayerPage from \"./Player\";\r\nimport { Map } from \"../models/Map\";\r\nimport { Token } from \"../models/Token\";\r\nimport { PlayMap } from \"../models/PlayMap\";\r\nimport { PlayToken } from \"../models/PlayToken\";\r\nimport { Mask, MaskPoint } from \"../models/Mask\";\r\nimport { FavoriteToken } from \"../models/FavoriteToken\";\r\nimport API from \"../smartAPI\";\r\n// import Grid from \"@material-ui/core/Grid\";\r\n// import {\r\n//   // toggleLogin\r\n// } from \"../redux/actions/index\";\r\n\r\ninterface AppState {\r\n  maps: Map[] | null\r\n}\r\n\r\ninterface RootState {\r\n  app: AppState\r\n}\r\n\r\nconst mapState = (state: RootState) => ({\r\n  maps: state.app.maps\r\n})\r\n\r\nconst mapDispatch = {\r\n  setMaps: (maps: Map[]) => ({ type: 'SET_MAPS', payload: maps }),\r\n  setPlayMaps: (playMaps: PlayMap[]) => ({ type: 'SET_PLAYMAPS', payload: playMaps }),\r\n  setTokens: (tokens: Token[]) => ({ type: 'SET_TOKENS', payload: tokens }),\r\n  setFavoriteTokens: (favoriteTokens: FavoriteToken[]) => ({ type: 'SET_FAVORITETOKENS', payload: favoriteTokens }),\r\n}\r\n\r\nconst connector = connect(mapState, mapDispatch)\r\n\r\ntype PropsFromRedux = ConnectedProps<typeof connector>\r\n\r\ntype Props = PropsFromRedux & { }\r\n\r\nexport interface IMainPageStateType { }\r\n\r\nclass MainPage extends Component<\r\n  Props,\r\n  IMainPageStateType\r\n> {\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.state = {\r\n      version: \"0\"\r\n    };\r\n    this.api = API.getInstance();\r\n  }\r\n\r\n  api: any;\r\n\r\n  componentDidMount() {\r\n  }\r\n\r\n  render() {\r\n    if (this.props.maps === null) {\r\n      this.api.getAllVTT(0, true).then((res: any) => {\r\n        if (res !== undefined && res.error === undefined) {\r\n          const maps: Map[] = [];\r\n          res.maps.forEach((m: any) => {\r\n            maps.push(new Map(m._id, m.name, m.fileName, m.gridWidth, m.gridHeight));\r\n          });\r\n          this.props.setMaps(maps);\r\n          const tokens: Token[] = [];\r\n          res.tokens.forEach((t: any) => {\r\n            tokens.push(new Token(t._id, t.fileName));\r\n          });\r\n          this.props.setTokens(tokens);\r\n          const favoriteTokens: FavoriteToken[] = [];\r\n          res.favoriteTokens.forEach((t: any) => {\r\n            const tokenFinder: Token[] = tokens.filter(t2 => t2._id === t.tokenID);\r\n            if (tokenFinder.length === 1)\r\n            {\r\n              const token: Token = tokenFinder[0];\r\n              favoriteTokens.push(new FavoriteToken(t._id, t.name, token, t.size));\r\n            }\r\n          });\r\n          this.props.setFavoriteTokens(favoriteTokens);\r\n          const playMaps: PlayMap[] = [];\r\n          res.playMaps.forEach((m: any) => {\r\n            const mapFinder: Map[] = maps.filter(m2 => m2._id === m.mapID);\r\n            if (mapFinder.length === 1)\r\n            {\r\n              const map: Map = mapFinder[0];\r\n              const playTokens: PlayToken[] = [];\r\n              m.playTokens.forEach((t: any) => {\r\n                const tokenFinder: Token[] = tokens.filter(t2 => t2._id === t.tokenID);\r\n                if (tokenFinder.length === 1)\r\n                {\r\n                  const token: Token = tokenFinder[0];\r\n                  playTokens.push(new PlayToken(t.id, t.name, token, t.x, t.y, t.size));\r\n                }\r\n              });\r\n              const lightMasks: Mask[] = [];\r\n              m.lightMasks.forEach((l: any) => {\r\n                const points: MaskPoint[] = [];\r\n                l.points.forEach((p: any) => {\r\n                  points.push(new MaskPoint(p.id, l.id, \"light\", p.x, p.y));\r\n                });\r\n                lightMasks.push(new Mask(l.id, \"light\", points));\r\n              });\r\n              const darkMasks: Mask[] = [];\r\n              m.darkMasks.forEach((l: any) => {\r\n                const points: MaskPoint[] = [];\r\n                l.points.forEach((p: any) => {\r\n                  points.push(new MaskPoint(p.id, l.id, \"dark\", p.x, p.y));\r\n                });\r\n                darkMasks.push(new Mask(l.id, \"dark\", points));\r\n              });\r\n              const fogMasks: Mask[] = [];\r\n              m.fogMasks.forEach((l: any) => {\r\n                const points: MaskPoint[] = [];\r\n                l.points.forEach((p: any) => {\r\n                  points.push(new MaskPoint(p.id, l.id, \"fog\", p.x, p.y));\r\n                });\r\n                fogMasks.push(new Mask(l.id, \"fog\", points));\r\n              });\r\n              playMaps.push(new PlayMap(m._id, m.name, map, playTokens, lightMasks, darkMasks, fogMasks, m.zoom, m.dx, m.dy));\r\n            }\r\n          });\r\n          this.props.setPlayMaps(playMaps);\r\n        }\r\n      });\r\n      return (\r\n        <div key=\"main\">Loading Data</div>\r\n      )\r\n    } else {\r\n      return (\r\n        <Switch>\r\n          <Route exact path=\"/\" component={HomePage} />\r\n          <Route exact path=\"/home\" component={HomePage} />\r\n          <Route exact path=\"/dm\" component={DMPage} />\r\n          <Route exact path=\"/player\" component={PlayerPage} />\r\n        </Switch>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\n// const MainPage = connect(mapStateToProps, mapDispatchToProps)(Page);\r\n// export default MainPage;\r\n\r\nexport default connector(MainPage);","\nimport React, { Component } from \"react\";\nimport \"./assets/css/material-dashboard-react.css\";\nimport {\n  BrowserRouter as Router\n} from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport MainPage from \"./views/MainPage\";\nimport Grid from \"@material-ui/core/Grid\";\n// import Box from \"@material-ui/core/Box\";\nimport { \n  // setWidth,\n  // setAPI\n} from \"./redux/actions/index\";\n// import API from \"./smartAPI\";\nimport \"./assets/css/quill.snow.css\";\n\nconst mapStateToProps = (state: any) => {\n  return {\n    // menuOpen: state.app.menuOpen,\n    // api: state.app.api\n  };\n};\nfunction mapDispatchToProps(dispatch: any) {\n  return {\n    // setWidth: (width: any) => dispatch(setWidth(width)),\n    // setAPI: (api: any) => dispatch(setAPI(api))\n  };\n}\ninterface IProps {\n  // menuOpen: boolean;\n  // api: any;\n  // setWidth: (width: any) => void;\n  // setAPI: (api: any) => void;\n}\n\ninterface IState {\n  version: string;\n  width: number;\n  innerWidth: number;\n  marginLeft: number;\n}\nclass AppLayout extends Component<IProps, IState> {\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      version: \"0\",\n      width: 0,\n      innerWidth: 0,\n      marginLeft: 220\n    };\n    // this.api = API.getInstance();\n  }\n\n  api: any;\n\n  props: any;\n\n  componentDidMount() {\n    this.updateDimensions();\n    window.addEventListener(\"resize\", this.updateDimensions.bind(this));\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.updateDimensions.bind(this));\n  }\n\n  updateDimensions() {\n    // let w = window.innerWidth;\n    // if (w >= 600) {\n    //   w -= 200;\n    //   this.props.setWidth(w);\n    //   this.setState({ width: w, marginLeft: 220, innerWidth: window.innerWidth });\n    // }\n    // else {\n      // this.props.setWidth(w);\n    //   this.setState({ width: w, marginLeft: 0, innerWidth: window.innerWidth });\n    // }\n  }\n\n  render() {\n    // if (this.props.api === null) {\n    //   this.props.setAPI(this.api);\n    // }\n    return (\n      <Router>\n        <Grid container>\n          <Grid item xs={12}\n            // style={{ \n            //   marginLeft: `${this.props.menuOpen ? this.state.marginLeft + 10 : 10}px`, \n            //   width: `${this.props.menuOpen ? this.state.width - 20 : this.state.innerWidth - 20}px`,\n            //   marginRight: \"10px\",\n            //   marginTop: \"10px\" \n            // }}\n            >\n            <MainPage />\n          </Grid>\n        </Grid>\n      </Router>\n    );\n  }\n}\n\nconst App = connect(mapStateToProps, mapDispatchToProps)(AppLayout);\nexport default App;\n\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import {\r\n  SET_MAPS,\r\n  ADD_MAP,\r\n  UPDATE_MAP,\r\n  // DELETE_MAP,\r\n  SET_TOKENS,\r\n  ADD_TOKEN,\r\n  UPDATE_TOKEN,\r\n  // DELETE_TOKEN,\r\n  SET_PLAYMAPS,\r\n  ADD_PLAYMAP,\r\n  UPDATE_PLAYMAP,\r\n  // DELETE_PLAYMAP,\r\n  SELECT_PLAYMAP,\r\n  SET_FAVORITETOKENS,\r\n  ADD_FAVORITETOKEN,\r\n  UPDATE_FAVORITETOKEN,\r\n  // DELETE_FAVORITETOKEN,\r\n  TOGGLE_IS_ON\r\n} from \"../constants/actionTypes\";\r\n\r\nconst initialState = {\r\n  maps: null,\r\n  tokens: null,\r\n  playMaps: null,\r\n  favoriteTokens: null,\r\n  selectedPlayMap: null,\r\n  isOn: true\r\n};\r\nfunction rootReducer(state = initialState, action) {\r\n  if (action.type === SET_MAPS) {\r\n    return Object.assign({}, state, {\r\n      maps: action.payload\r\n    });\r\n  } else if (action.type === SET_TOKENS) {\r\n    return Object.assign({}, state, {\r\n      tokens: action.payload\r\n    });\r\n  } else if (action.type === SET_PLAYMAPS) {\r\n    return Object.assign({}, state, {\r\n      playMaps: action.payload\r\n    });\r\n  } else if (action.type === SET_FAVORITETOKENS) {\r\n    return Object.assign({}, state, {\r\n      favoriteTokens: action.payload\r\n    });\r\n  } else if (action.type === ADD_MAP) {\r\n    const maps = state.maps;\r\n    maps.push(action.payload);\r\n    return Object.assign({}, state, {\r\n      maps\r\n    });\r\n  } else if (action.type === ADD_TOKEN) {\r\n    const tokens = state.tokens;\r\n    tokens.push(action.payload);\r\n    return Object.assign({}, state, {\r\n      tokens\r\n    });\r\n  } else if (action.type === ADD_PLAYMAP) {\r\n    const playMaps = state.playMaps;\r\n    playMaps.push(action.payload);\r\n    return Object.assign({}, state, {\r\n      playMaps\r\n    });\r\n  } else if (action.type === ADD_FAVORITETOKEN) {\r\n    const favoriteTokens = state.favoriteTokens;\r\n    favoriteTokens.push(action.payload);\r\n    return Object.assign({}, state, {\r\n      favoriteTokens\r\n    });\r\n  } else if (action.type === UPDATE_MAP) {\r\n    const maps = state.maps;\r\n    const mapFinder = maps.filter(m => m._id === action.payload._id);\r\n    if (mapFinder.length === 1) {\r\n      const map = mapFinder[0];\r\n      map.name = action.payload.name;\r\n      map.file = action.payload.file;\r\n      map.gridWidth = action.payload.gridWidth;\r\n      map.gridHeight = action.payload.gridHeight;\r\n    }\r\n    return Object.assign({}, state, {\r\n      maps\r\n    });\r\n  } else if (action.type === UPDATE_TOKEN) {\r\n    const tokens = state.tokens;\r\n    const tokenFinder = tokens.filter(t => t._id === action.payload._id);\r\n    if (tokenFinder.length === 1) {\r\n      const token = tokenFinder[0];\r\n      token.file = action.payload.file;\r\n    }\r\n    return Object.assign({}, state, {\r\n      tokens\r\n    });\r\n  } else if (action.type === UPDATE_PLAYMAP) {\r\n    const playMaps = state.playMaps;\r\n    let selectedPlayMap = state.selectedPlayMap;\r\n    const playMapFinder = playMaps.filter(m => m._id === action.payload._id);\r\n    if (playMapFinder.length === 1) {\r\n      const playMap = playMapFinder[0];\r\n      playMap.name = action.payload.name;\r\n      playMap.map = action.payload.map;\r\n      playMap.tokens = action.payload.tokens;\r\n      playMap.lightMasks = action.payload.lightMasks;\r\n      playMap.zoom = action.payload.zoom;\r\n      playMap.dx = action.payload.dx;\r\n      playMap.dy = action.payload.dy;\r\n\r\n      if (selectedPlayMap._id === playMap._id) {\r\n        selectedPlayMap = playMap;\r\n      }\r\n    }\r\n    return Object.assign({}, state, {\r\n      playMaps,\r\n      selectedPlayMap\r\n    });\r\n  } else if (action.type === UPDATE_FAVORITETOKEN) {\r\n    const favoriteTokens = state.favoriteTokens;\r\n    const favoriteTokenFinder = favoriteTokens.filter(t => t._id === action.payload._id);\r\n    if (favoriteTokenFinder.length === 1) {\r\n      const favoriteToken = favoriteTokenFinder[0];\r\n      favoriteToken.file = action.payload.file;\r\n    }\r\n    return Object.assign({}, state, {\r\n      favoriteTokens\r\n    });\r\n  } else if (action.type === SELECT_PLAYMAP) {\r\n    return Object.assign({}, state, {\r\n      selectedPlayMap: action.payload\r\n    });\r\n  } else if (action.type === TOGGLE_IS_ON) {\r\n    return Object.assign({}, state, {\r\n      isOn: !state.isOn\r\n    });\r\n  }\r\n  return state;\r\n}\r\n\r\nexport default rootReducer;\r\n\r\nexport const login = (user, history) => {};\r\n\r\nexport const logout = history => {};\r\n","import { createStore, combineReducers } from \"redux\";\r\nimport { sessionService, sessionReducer } from \"redux-react-session\";\r\nimport rootReducer from \"../reducers/index\";\r\nconst reducers = {\r\n  app: rootReducer,\r\n  session: sessionReducer\r\n};\r\n\r\nconst reducer = combineReducers(reducers);\r\nconst store = createStore(reducer);\r\nconst validateSession = session => {\r\n  // check if your session is still valid\r\n  return true;\r\n};\r\nconst options = {\r\n  refreshFromLocalStorage: true,\r\n  refreshOnCheckAuth: true,\r\n  redirectPath: \"/home\",\r\n  driver: \"COOKIES\",\r\n  validateSession\r\n};\r\n\r\nsessionService\r\n  .initSessionService(store, options)\r\n  .then(() =>\r\n    console.log(\r\n      \"Redux React Session is ready and a session was refreshed from your storage\"\r\n    )\r\n  )\r\n  .catch(() =>\r\n    console.log(\r\n      \"Redux React Session is ready and there is no session in your storage\"\r\n    )\r\n  );\r\nexport default store;\r\n","\r\nexport const SET_MAPS = \"SET_MAPS\";\r\nexport const ADD_MAP = \"ADD_MAP\";\r\nexport const UPDATE_MAP = \"UPDATE_MAP\";\r\nexport const DELETE_MAP = \"DELETE_MAP\";\r\nexport const SET_TOKENS = \"SET_TOKENS\";\r\nexport const ADD_TOKEN = \"ADD_TOKEN\";\r\nexport const UPDATE_TOKEN = \"UPDATE_TOKEN\";\r\nexport const DELETE_TOKEN = \"DELETE_TOKEN\";\r\nexport const SET_PLAYMAPS = \"SET_PLAYMAPS\";\r\nexport const ADD_PLAYMAP = \"ADD_PLAYMAP\";\r\nexport const UPDATE_PLAYMAP = \"UPDATE_PLAYMAP\";\r\nexport const DELETE_PLAYMAP = \"DELETE_PLAYMAP\";\r\nexport const SELECT_PLAYMAP = \"SELECT_PLAYMAP\";\r\nexport const SET_FAVORITETOKENS = \"SET_FAVORITETOKENS\";\r\nexport const ADD_FAVORITETOKEN = \"ADD_FAVORITETOKEN\";\r\nexport const UPDATE_FAVORITETOKEN = \"UPDATE_FAVORITETOKEN\";\r\nexport const DELETE_FAVORITETOKEN = \"DELETE_FAVORITETOKEN\";\r\n\r\nexport const TOGGLE_IS_ON = \"TOGGLE_IS_ON\";\r\n","// import React from 'react';\n// import ReactDOM from 'react-dom';\n// import './index.css';\n// import App from './App';\n// import * as serviceWorker from './serviceWorker';\n\n// ReactDOM.render(<App />, document.getElementById('root'));\n\n// // If you want your app to work offline and load faster, you can change\n// // unregister() to register() below. Note this comes with some pitfalls.\n// // Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport { Provider } from \"react-redux\";\nimport store from \"./redux/store/index\";\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}